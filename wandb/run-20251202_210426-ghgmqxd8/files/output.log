Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 60 training samples (20/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 28.96it/s, loss=0.5323]
Epoch 1: Loss=0.5500, Val Acc=0.9022
  → Best model saved (0.9022)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.68it/s, loss=0.2584]
Epoch 2: Loss=0.3142, Val Acc=0.9111
  → Best model saved (0.9111)
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.49it/s, loss=0.1935]
Epoch 3: Loss=0.2278, Val Acc=0.9511
  → Best model saved (0.9511)
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.26it/s, loss=0.1941]
Epoch 4: Loss=0.2002, Val Acc=0.9689
  → Best model saved (0.9689)
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.03it/s, loss=0.1885]
Epoch 5: Loss=0.1930, Val Acc=0.9467
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.12it/s, loss=0.1826]
Epoch 6: Loss=0.1870, Val Acc=0.8800
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.48it/s, loss=0.1808]
Epoch 7: Loss=0.1875, Val Acc=0.9333
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.79it/s, loss=0.1790]
Epoch 8: Loss=0.1805, Val Acc=0.9422
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.30it/s, loss=0.1889]
Epoch 9: Loss=0.1756, Val Acc=0.9467
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.14it/s, loss=0.1706]
Epoch 10: Loss=0.1719, Val Acc=0.9200
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.92it/s, loss=0.1668]
Epoch 11: Loss=0.1693, Val Acc=0.9289
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.38it/s, loss=0.1725]
Epoch 12: Loss=0.1685, Val Acc=0.9289
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.91it/s, loss=0.1729]
Epoch 13: Loss=0.1679, Val Acc=0.9289
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.74it/s, loss=0.1659]
Epoch 14: Loss=0.1675, Val Acc=0.9200
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.59it/s, loss=0.1638]
Epoch 15: Loss=0.1670, Val Acc=0.9333
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.32it/s, loss=0.1642]
Epoch 16: Loss=0.1664, Val Acc=0.9378
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.60it/s, loss=0.1629]
Epoch 17: Loss=0.1660, Val Acc=0.9289
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.60it/s, loss=0.1708]
Epoch 18: Loss=0.1655, Val Acc=0.9467
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.59it/s, loss=0.1629]
Epoch 19: Loss=0.1651, Val Acc=0.9422
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.55it/s, loss=0.1708]
Epoch 20: Loss=0.1646, Val Acc=0.9244
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.18it/s, loss=0.1622]
Epoch 21: Loss=0.1642, Val Acc=0.9244
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.54it/s, loss=0.1675]
Epoch 22: Loss=0.1641, Val Acc=0.9467
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.98it/s, loss=0.1695]
Epoch 23: Loss=0.1641, Val Acc=0.9378
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.28it/s, loss=0.1671]
Epoch 24: Loss=0.1640, Val Acc=0.9200
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.72it/s, loss=0.1650]
Epoch 25: Loss=0.1639, Val Acc=0.9333
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.37it/s, loss=0.1642]
Epoch 26: Loss=0.1639, Val Acc=0.9289
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.50it/s, loss=0.1615]
Epoch 27: Loss=0.1638, Val Acc=0.9333
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.34it/s, loss=0.1625]
Epoch 28: Loss=0.1637, Val Acc=0.9333
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.06it/s, loss=0.1605]
Epoch 29: Loss=0.1637, Val Acc=0.9333
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.24it/s, loss=0.1628]
Epoch 30: Loss=0.1636, Val Acc=0.9289
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.06it/s, loss=0.1690]
Epoch 31: Loss=0.1636, Val Acc=0.9333
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.20it/s, loss=0.1594]
Epoch 32: Loss=0.1636, Val Acc=0.9289
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.62it/s, loss=0.1638]
Epoch 33: Loss=0.1636, Val Acc=0.9422
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.16it/s, loss=0.1612]
Epoch 34: Loss=0.1635, Val Acc=0.9422
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.90it/s, loss=0.1609]
Epoch 35: Loss=0.1635, Val Acc=0.9333
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.38it/s, loss=0.1616]
Epoch 36: Loss=0.1635, Val Acc=0.9333
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.45it/s, loss=0.1609]
Epoch 37: Loss=0.1635, Val Acc=0.9378
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.88it/s, loss=0.1638]
Epoch 38: Loss=0.1635, Val Acc=0.9467
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.76it/s, loss=0.1655]
Epoch 39: Loss=0.1635, Val Acc=0.9422
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.79it/s, loss=0.1620]
Epoch 40: Loss=0.1635, Val Acc=0.9333
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.09it/s, loss=0.1608]
Epoch 41: Loss=0.1635, Val Acc=0.9333
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.83it/s, loss=0.1623]
Epoch 42: Loss=0.1635, Val Acc=0.9422
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.16it/s, loss=0.1761]
Epoch 43: Loss=0.1635, Val Acc=0.9422
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.61it/s, loss=0.1686]
Epoch 44: Loss=0.1635, Val Acc=0.9333
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.33it/s, loss=0.1637]
Epoch 45: Loss=0.1635, Val Acc=0.9378
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.90it/s, loss=0.1601]
Epoch 46: Loss=0.1635, Val Acc=0.9244
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.75it/s, loss=0.1606]
Epoch 47: Loss=0.1635, Val Acc=0.9378
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.63it/s, loss=0.1611]
Epoch 48: Loss=0.1635, Val Acc=0.9333
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.59it/s, loss=0.1632]
Epoch 49: Loss=0.1635, Val Acc=0.9378
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.66it/s, loss=0.1611]
Epoch 50: Loss=0.1635, Val Acc=0.9244
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.02it/s, loss=0.1615]
Epoch 51: Loss=0.1635, Val Acc=0.9289
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.12it/s, loss=0.1660]
Epoch 52: Loss=0.1635, Val Acc=0.9378
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.23it/s, loss=0.1670]
Epoch 53: Loss=0.1635, Val Acc=0.9333
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.84it/s, loss=0.1612]
Epoch 54: Loss=0.1635, Val Acc=0.9289
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.57it/s, loss=0.1615]
Epoch 55: Loss=0.1635, Val Acc=0.9200
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.08it/s, loss=0.1632]
Epoch 56: Loss=0.1635, Val Acc=0.9333
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.19it/s, loss=0.1589]
Epoch 57: Loss=0.1635, Val Acc=0.9244
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.61it/s, loss=0.1687]
Epoch 58: Loss=0.1635, Val Acc=0.9467
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.52it/s, loss=0.1667]
Epoch 59: Loss=0.1635, Val Acc=0.9378
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.57it/s, loss=0.1646]
Epoch 60: Loss=0.1635, Val Acc=0.9378
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.05it/s, loss=0.1612]
Epoch 61: Loss=0.1635, Val Acc=0.9244
Epoch 62/70: 100%|██| 100/100 [00:02<00:00, 35.96it/s, loss=0.1617]
Epoch 62: Loss=0.1635, Val Acc=0.9422
Epoch 63/70: 100%|██| 100/100 [00:02<00:00, 34.71it/s, loss=0.1614]
Epoch 63: Loss=0.1635, Val Acc=0.9200
Epoch 64/70: 100%|██| 100/100 [00:02<00:00, 34.47it/s, loss=0.1608]
Epoch 64: Loss=0.1635, Val Acc=0.9333
Epoch 65/70: 100%|██| 100/100 [00:03<00:00, 31.42it/s, loss=0.1606]
Epoch 65: Loss=0.1635, Val Acc=0.9333
Epoch 66/70: 100%|██| 100/100 [00:03<00:00, 32.90it/s, loss=0.1619]
Epoch 66: Loss=0.1635, Val Acc=0.9333
Epoch 67/70: 100%|██| 100/100 [00:02<00:00, 34.21it/s, loss=0.1632]
Epoch 67: Loss=0.1635, Val Acc=0.9422
Epoch 68/70: 100%|██| 100/100 [00:02<00:00, 35.21it/s, loss=0.1708]
Epoch 68: Loss=0.1635, Val Acc=0.9289
Epoch 69/70: 100%|██| 100/100 [00:02<00:00, 36.06it/s, loss=0.1655]
Epoch 69: Loss=0.1635, Val Acc=0.9333
Epoch 70/70: 100%|██| 100/100 [00:02<00:00, 34.95it/s, loss=0.1606]
Epoch 70: Loss=0.1635, Val Acc=0.9333

==================================================
Final Test: cosine | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|██████████████████| 150/150 [00:00<00:00, 422.53it/s]

Accuracy : 0.9822
Precision: 0.9831
Recall   : 0.9822
F1-Score : 0.9822
p-value  : 1.94e-187
Saved: results/confusion_matrix_cosine_5shot_60samples.png
Saved: results/tsne_cosine_5shot_60samples.png

Results logged to WandB and plots saved to results/
