Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 90 training samples (30/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 71.88it/s, loss=0.2341]
Epoch 1: Loss=0.3697, Val Acc=0.9067
  → Best model saved (0.9067)
Epoch 2/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.55it/s, loss=0.3232]
Epoch 2: Loss=0.2542, Val Acc=0.9556
  → Best model saved (0.9556)
Epoch 3/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.57it/s, loss=0.1976]
Epoch 3: Loss=0.2171, Val Acc=0.9244
Epoch 4/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 138.22it/s, loss=0.1951]
Epoch 4: Loss=0.2015, Val Acc=0.9422
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 93.94it/s, loss=0.1986]
Epoch 5: Loss=0.1964, Val Acc=0.9333
Epoch 6/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.82it/s, loss=0.1935]
Epoch 6: Loss=0.1924, Val Acc=0.9467
Epoch 7/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.43it/s, loss=0.1840]
Epoch 7: Loss=0.1890, Val Acc=0.9289
Epoch 8/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 135.30it/s, loss=0.2068]
Epoch 8: Loss=0.1856, Val Acc=0.9378
Epoch 9/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.93it/s, loss=0.1846]
Epoch 9: Loss=0.1824, Val Acc=0.9289
Epoch 10/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 134.55it/s, loss=0.1719]
Epoch 10: Loss=0.1797, Val Acc=0.9378
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.38it/s, loss=0.1786]
Epoch 11: Loss=0.1777, Val Acc=0.9289
Epoch 12/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.29it/s, loss=0.1803]
Epoch 12: Loss=0.1773, Val Acc=0.9333
Epoch 13/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.20it/s, loss=0.1820]
Epoch 13: Loss=0.1770, Val Acc=0.9333
Epoch 14/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 138.24it/s, loss=0.1769]
Epoch 14: Loss=0.1767, Val Acc=0.9333
Epoch 15/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 142.62it/s, loss=0.1713]
Epoch 15: Loss=0.1764, Val Acc=0.9289
Epoch 16/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.97it/s, loss=0.1983]
Epoch 16: Loss=0.1760, Val Acc=0.9333
Epoch 17/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.88it/s, loss=0.1781]
Epoch 17: Loss=0.1756, Val Acc=0.9289
Epoch 18/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 127.97it/s, loss=0.1803]
Epoch 18: Loss=0.1753, Val Acc=0.9289
Epoch 19/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.82it/s, loss=0.1712]
Epoch 19: Loss=0.1749, Val Acc=0.9333
Epoch 20/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 128.24it/s, loss=0.1714]
Epoch 20: Loss=0.1745, Val Acc=0.9422
Epoch 21/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 121.74it/s, loss=0.1795]
Epoch 21: Loss=0.1743, Val Acc=0.9333
Epoch 22/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 138.38it/s, loss=0.1769]
Epoch 22: Loss=0.1742, Val Acc=0.9333
Epoch 23/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 130.60it/s, loss=0.1745]
Epoch 23: Loss=0.1741, Val Acc=0.9333
Epoch 24/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 121.31it/s, loss=0.1760]
Epoch 24: Loss=0.1741, Val Acc=0.9333
Epoch 25/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 128.75it/s, loss=0.1712]
Epoch 25: Loss=0.1740, Val Acc=0.9333
Epoch 26/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 129.98it/s, loss=0.1733]
Epoch 26: Loss=0.1740, Val Acc=0.9333
Epoch 27/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 104.38it/s, loss=0.1811]
Epoch 27: Loss=0.1739, Val Acc=0.9333
Epoch 28/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.63it/s, loss=0.1826]
Epoch 28: Loss=0.1739, Val Acc=0.9289
Epoch 29/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.12it/s, loss=0.1708]
Epoch 29: Loss=0.1738, Val Acc=0.9333
Epoch 30/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.07it/s, loss=0.1877]
Epoch 30: Loss=0.1738, Val Acc=0.9289
Epoch 31/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 138.90it/s, loss=0.1741]
Epoch 31: Loss=0.1737, Val Acc=0.9333
Epoch 32/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 129.08it/s, loss=0.1732]
Epoch 32: Loss=0.1737, Val Acc=0.9378
Epoch 33/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.90it/s, loss=0.1810]
Epoch 33: Loss=0.1737, Val Acc=0.9333
Epoch 34/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.03it/s, loss=0.1809]
Epoch 34: Loss=0.1737, Val Acc=0.9333
Epoch 35/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 127.17it/s, loss=0.1726]
Epoch 35: Loss=0.1737, Val Acc=0.9333
Epoch 36/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.51it/s, loss=0.1702]
Epoch 36: Loss=0.1737, Val Acc=0.9333
Epoch 37/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 131.56it/s, loss=0.1735]
Epoch 37: Loss=0.1737, Val Acc=0.9333
Epoch 38/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.63it/s, loss=0.1713]
Epoch 38: Loss=0.1737, Val Acc=0.9333
Epoch 39/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.95it/s, loss=0.1686]
Epoch 39: Loss=0.1737, Val Acc=0.9333
Epoch 40/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.71it/s, loss=0.1742]
Epoch 40: Loss=0.1737, Val Acc=0.9333
Epoch 41/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.01it/s, loss=0.1683]
Epoch 41: Loss=0.1737, Val Acc=0.9333
Epoch 42/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 135.81it/s, loss=0.2001]
Epoch 42: Loss=0.1737, Val Acc=0.9333
Epoch 43/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.24it/s, loss=0.1772]
Epoch 43: Loss=0.1737, Val Acc=0.9378
Epoch 44/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.86it/s, loss=0.1723]
Epoch 44: Loss=0.1737, Val Acc=0.9289
Epoch 45/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 117.29it/s, loss=0.1713]
Epoch 45: Loss=0.1737, Val Acc=0.9333
Epoch 46/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.43it/s, loss=0.1707]
Epoch 46: Loss=0.1737, Val Acc=0.9333
Epoch 47/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.45it/s, loss=0.1712]
Epoch 47: Loss=0.1737, Val Acc=0.9333
Epoch 48/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 143.01it/s, loss=0.1710]
Epoch 48: Loss=0.1737, Val Acc=0.9333
Epoch 49/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 140.15it/s, loss=0.1674]
Epoch 49: Loss=0.1737, Val Acc=0.9378
Epoch 50/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 128.38it/s, loss=0.1967]
Epoch 50: Loss=0.1737, Val Acc=0.9333
Epoch 51/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.13it/s, loss=0.1721]
Epoch 51: Loss=0.1737, Val Acc=0.9333
Epoch 52/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 129.58it/s, loss=0.1792]
Epoch 52: Loss=0.1737, Val Acc=0.9333
Epoch 53/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 140.54it/s, loss=0.1764]
Epoch 53: Loss=0.1737, Val Acc=0.9333
Epoch 54/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 123.29it/s, loss=0.1809]
Epoch 54: Loss=0.1737, Val Acc=0.9333
Epoch 55/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.98it/s, loss=0.1721]
Epoch 55: Loss=0.1737, Val Acc=0.9333
Epoch 56/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.09it/s, loss=0.1728]
Epoch 56: Loss=0.1737, Val Acc=0.9333
Epoch 57/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 106.15it/s, loss=0.1679]
Epoch 57: Loss=0.1737, Val Acc=0.9333
Epoch 58/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.91it/s, loss=0.1771]
Epoch 58: Loss=0.1737, Val Acc=0.9289
Epoch 59/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.23it/s, loss=0.1757]
Epoch 59: Loss=0.1737, Val Acc=0.9333
Epoch 60/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 139.65it/s, loss=0.1729]
Epoch 60: Loss=0.1737, Val Acc=0.9378
Epoch 61/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 135.41it/s, loss=0.1679]
Epoch 61: Loss=0.1737, Val Acc=0.9333
Epoch 62/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.30it/s, loss=0.1729]
Epoch 62: Loss=0.1737, Val Acc=0.9333
Epoch 63/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.28it/s, loss=0.1782]
Epoch 63: Loss=0.1737, Val Acc=0.9333
Epoch 64/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 123.98it/s, loss=0.1705]
Epoch 64: Loss=0.1737, Val Acc=0.9333
Epoch 65/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 123.62it/s, loss=0.1712]
Epoch 65: Loss=0.1737, Val Acc=0.9333
Epoch 66/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 138.69it/s, loss=0.1722]
Epoch 66: Loss=0.1737, Val Acc=0.9333
Epoch 67/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 127.37it/s, loss=0.1778]
Epoch 67: Loss=0.1737, Val Acc=0.9333
Epoch 68/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.50it/s, loss=0.1707]
Epoch 68: Loss=0.1737, Val Acc=0.9333
Epoch 69/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.31it/s, loss=0.1686]
Epoch 69: Loss=0.1737, Val Acc=0.9333
Epoch 70/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.97it/s, loss=0.1712]
Epoch 70: Loss=0.1737, Val Acc=0.9333

==================================================
Final Test: protonet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 489.19it/s]

Accuracy : 0.9533
Precision: 0.9580
Recall   : 0.9533
F1-Score : 0.9531
p-value  : 2.67e-171
Saved: results/confusion_matrix_protonet_5shot_90samples.png
Saved: results/tsne_protonet_5shot_90samples.png

Results logged to WandB and plots saved to results/
