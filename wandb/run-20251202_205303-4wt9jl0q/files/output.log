Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 30 training samples (10/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 56.88it/s, loss=0.6163]
Epoch 1: Loss=0.7657, Val Acc=0.8667
  → Best model saved (0.8667)
Epoch 2/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.64it/s, loss=0.5756]
Epoch 2: Loss=0.5951, Val Acc=0.9422
  → Best model saved (0.9422)
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 73.81it/s, loss=0.5609]
Epoch 3: Loss=0.5705, Val Acc=0.9422
Epoch 4/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 112.98it/s, loss=0.5498]
Epoch 4: Loss=0.5585, Val Acc=0.9200
Epoch 5/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 101.65it/s, loss=0.5511]
Epoch 5: Loss=0.5488, Val Acc=0.9467
  → Best model saved (0.9467)
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.62it/s, loss=0.5380]
Epoch 6: Loss=0.5426, Val Acc=0.9333
Epoch 7/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.31it/s, loss=0.5318]
Epoch 7: Loss=0.5399, Val Acc=0.9156
Epoch 8/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.60it/s, loss=0.5340]
Epoch 8: Loss=0.5325, Val Acc=0.9378
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.79it/s, loss=0.5338]
Epoch 9: Loss=0.5276, Val Acc=0.9333
Epoch 10/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 104.30it/s, loss=0.5170]
Epoch 10: Loss=0.5236, Val Acc=0.9200
Epoch 11/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 112.47it/s, loss=0.5154]
Epoch 11: Loss=0.5200, Val Acc=0.9378
Epoch 12/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.35it/s, loss=0.5184]
Epoch 12: Loss=0.5192, Val Acc=0.9333
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.33it/s, loss=0.5190]
Epoch 13: Loss=0.5186, Val Acc=0.9333
Epoch 14/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.86it/s, loss=0.5171]
Epoch 14: Loss=0.5181, Val Acc=0.9378
Epoch 15/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.78it/s, loss=0.5125]
Epoch 15: Loss=0.5176, Val Acc=0.9289
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 74.29it/s, loss=0.5224]
Epoch 16: Loss=0.5172, Val Acc=0.9289
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 88.94it/s, loss=0.5112]
Epoch 17: Loss=0.5167, Val Acc=0.9333
Epoch 18/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.38it/s, loss=0.5168]
Epoch 18: Loss=0.5161, Val Acc=0.9289
Epoch 19/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.61it/s, loss=0.5148]
Epoch 19: Loss=0.5157, Val Acc=0.9289
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 78.96it/s, loss=0.5147]
Epoch 20: Loss=0.5152, Val Acc=0.9289
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 75.59it/s, loss=0.5102]
Epoch 21: Loss=0.5148, Val Acc=0.9378
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 89.14it/s, loss=0.5114]
Epoch 22: Loss=0.5147, Val Acc=0.9333
Epoch 23/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 101.75it/s, loss=0.5101]
Epoch 23: Loss=0.5147, Val Acc=0.9289
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 85.66it/s, loss=0.5114]
Epoch 24: Loss=0.5146, Val Acc=0.9333
Epoch 25/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.74it/s, loss=0.5105]
Epoch 25: Loss=0.5145, Val Acc=0.9333
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.00it/s, loss=0.5149]
Epoch 26: Loss=0.5145, Val Acc=0.9289
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 72.22it/s, loss=0.5120]
Epoch 27: Loss=0.5144, Val Acc=0.9333
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.80it/s, loss=0.5159]
Epoch 28: Loss=0.5144, Val Acc=0.9289
Epoch 29/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 104.45it/s, loss=0.5129]
Epoch 29: Loss=0.5143, Val Acc=0.9289
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 84.17it/s, loss=0.5117]
Epoch 30: Loss=0.5143, Val Acc=0.9333
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.95it/s, loss=0.5097]
Epoch 31: Loss=0.5142, Val Acc=0.9333
Epoch 32/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 103.65it/s, loss=0.5163]
Epoch 32: Loss=0.5142, Val Acc=0.9333
Epoch 33/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.94it/s, loss=0.5132]
Epoch 33: Loss=0.5142, Val Acc=0.9333
Epoch 34/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.72it/s, loss=0.5119]
Epoch 34: Loss=0.5142, Val Acc=0.9378
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 71.73it/s, loss=0.5129]
Epoch 35: Loss=0.5142, Val Acc=0.9333
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 91.50it/s, loss=0.5131]
Epoch 36: Loss=0.5142, Val Acc=0.9333
Epoch 37/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.40it/s, loss=0.5112]
Epoch 37: Loss=0.5142, Val Acc=0.9378
Epoch 38/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.08it/s, loss=0.5220]
Epoch 38: Loss=0.5142, Val Acc=0.9289
Epoch 39/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.94it/s, loss=0.5095]
Epoch 39: Loss=0.5142, Val Acc=0.9333
Epoch 40/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 101.39it/s, loss=0.5133]
Epoch 40: Loss=0.5141, Val Acc=0.9289
Epoch 41/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.99it/s, loss=0.5180]
Epoch 41: Loss=0.5141, Val Acc=0.9289
Epoch 42/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.92it/s, loss=0.5090]
Epoch 42: Loss=0.5141, Val Acc=0.9333
Epoch 43/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.63it/s, loss=0.5202]
Epoch 43: Loss=0.5141, Val Acc=0.9289
Epoch 44/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 132.36it/s, loss=0.5212]
Epoch 44: Loss=0.5141, Val Acc=0.9333
Epoch 45/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.94it/s, loss=0.5219]
Epoch 45: Loss=0.5141, Val Acc=0.9289
Epoch 46/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.69it/s, loss=0.5099]
Epoch 46: Loss=0.5141, Val Acc=0.9289
Epoch 47/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.55it/s, loss=0.5114]
Epoch 47: Loss=0.5141, Val Acc=0.9333
Epoch 48/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.60it/s, loss=0.5105]
Epoch 48: Loss=0.5141, Val Acc=0.9333
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 75.70it/s, loss=0.5094]
Epoch 49: Loss=0.5141, Val Acc=0.9289
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 74.96it/s, loss=0.5195]
Epoch 50: Loss=0.5141, Val Acc=0.9333
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 77.35it/s, loss=0.5122]
Epoch 51: Loss=0.5141, Val Acc=0.9333
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.77it/s, loss=0.5165]
Epoch 52: Loss=0.5141, Val Acc=0.9289
Epoch 53/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.65it/s, loss=0.5109]
Epoch 53: Loss=0.5141, Val Acc=0.9333
Epoch 54/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.45it/s, loss=0.5118]
Epoch 54: Loss=0.5141, Val Acc=0.9289
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 92.73it/s, loss=0.5122]
Epoch 55: Loss=0.5141, Val Acc=0.9289
Epoch 56/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 106.71it/s, loss=0.5109]
Epoch 56: Loss=0.5141, Val Acc=0.9333
Epoch 57/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.87it/s, loss=0.5161]
Epoch 57: Loss=0.5141, Val Acc=0.9333
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 83.52it/s, loss=0.5139]
Epoch 58: Loss=0.5141, Val Acc=0.9289
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.38it/s, loss=0.5110]
Epoch 59: Loss=0.5141, Val Acc=0.9289
Epoch 60/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 102.57it/s, loss=0.5125]
Epoch 60: Loss=0.5141, Val Acc=0.9333
Epoch 61/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.15it/s, loss=0.5131]
Epoch 61: Loss=0.5141, Val Acc=0.9289
Epoch 62/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.67it/s, loss=0.5108]
Epoch 62: Loss=0.5141, Val Acc=0.9289
Epoch 63/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 103.04it/s, loss=0.5095]
Epoch 63: Loss=0.5141, Val Acc=0.9289
Epoch 64/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.91it/s, loss=0.5106]
Epoch 64: Loss=0.5141, Val Acc=0.9333
Epoch 65/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.82it/s, loss=0.5114]
Epoch 65: Loss=0.5141, Val Acc=0.9333
Epoch 66/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 104.20it/s, loss=0.5158]
Epoch 66: Loss=0.5141, Val Acc=0.9289
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.78it/s, loss=0.5119]
Epoch 67: Loss=0.5141, Val Acc=0.9289
Epoch 68/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.79it/s, loss=0.5141]
Epoch 68: Loss=0.5141, Val Acc=0.9333
Epoch 69/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.27it/s, loss=0.5095]
Epoch 69: Loss=0.5141, Val Acc=0.9289
Epoch 70/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.30it/s, loss=0.5114]
Epoch 70: Loss=0.5141, Val Acc=0.9289

==================================================
Final Test: cosine | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 451.67it/s]

Accuracy : 0.9400
Precision: 0.9468
Recall   : 0.9400
F1-Score : 0.9406
p-value  : 4.24e-164
Saved: results/confusion_matrix_cosine_5shot_30samples.png
Saved: results/tsne_cosine_5shot_30samples.png

Results logged to WandB and plots saved to results/
