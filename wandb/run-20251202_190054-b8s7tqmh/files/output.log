Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 90 training samples (30/class)
initialization method [normal]
Epoch 1/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.68it/s, loss=0.1942]
Epoch 1: Loss=0.3869, Val Acc=0.4978
  → Best model saved (0.4978)
Epoch 2/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.34it/s, loss=0.2253]
Epoch 2: Loss=0.2561, Val Acc=0.4222
Epoch 3/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 39.41it/s, loss=0.2878]
Epoch 3: Loss=0.2232, Val Acc=0.4178
Epoch 4/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 49.67it/s, loss=0.1895]
Epoch 4: Loss=0.2088, Val Acc=0.3600
Epoch 5/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.22it/s, loss=0.1846]
Epoch 5: Loss=0.1950, Val Acc=0.3556
Epoch 6/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.87it/s, loss=0.1987]
Epoch 6: Loss=0.1951, Val Acc=0.3689
Epoch 7/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.91it/s, loss=0.1794]
Epoch 7: Loss=0.1910, Val Acc=0.4356
Epoch 8/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.68it/s, loss=0.1782]
Epoch 8: Loss=0.1853, Val Acc=0.4222
Epoch 9/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.11it/s, loss=0.1812]
Epoch 9: Loss=0.1897, Val Acc=0.4178
Epoch 10/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.79it/s, loss=0.1740]
Epoch 10: Loss=0.1796, Val Acc=0.4267
Epoch 11/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.55it/s, loss=0.1703]
Epoch 11: Loss=0.1743, Val Acc=0.4356
Epoch 12/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.65it/s, loss=0.1722]
Epoch 12: Loss=0.1731, Val Acc=0.4400
Epoch 13/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.53it/s, loss=0.1779]
Epoch 13: Loss=0.1726, Val Acc=0.4578
Epoch 14/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.14it/s, loss=0.1733]
Epoch 14: Loss=0.1721, Val Acc=0.4222
Epoch 15/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.42it/s, loss=0.1765]
Epoch 15: Loss=0.1715, Val Acc=0.4844
Epoch 16/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.70it/s, loss=0.1750]
Epoch 16: Loss=0.1712, Val Acc=0.4400
Epoch 17/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.57it/s, loss=0.1680]
Epoch 17: Loss=0.1706, Val Acc=0.3956
Epoch 18/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.86it/s, loss=0.1690]
Epoch 18: Loss=0.1701, Val Acc=0.4844
Epoch 19/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.07it/s, loss=0.1752]
Epoch 19: Loss=0.1698, Val Acc=0.4800
Epoch 20/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.09it/s, loss=0.1671]
Epoch 20: Loss=0.1693, Val Acc=0.3956
Epoch 21/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.23it/s, loss=0.1745]
Epoch 21: Loss=0.1691, Val Acc=0.4844
Epoch 22/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.42it/s, loss=0.1734]
Epoch 22: Loss=0.1690, Val Acc=0.4356
Epoch 23/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.88it/s, loss=0.1743]
Epoch 23: Loss=0.1688, Val Acc=0.4578
Epoch 24/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.48it/s, loss=0.1683]
Epoch 24: Loss=0.1687, Val Acc=0.4533
Epoch 25/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.20it/s, loss=0.1655]
Epoch 25: Loss=0.1686, Val Acc=0.4267
Epoch 26/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.89it/s, loss=0.1681]
Epoch 26: Loss=0.1685, Val Acc=0.4711
Epoch 27/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.87it/s, loss=0.1736]
Epoch 27: Loss=0.1685, Val Acc=0.4356
Epoch 28/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.15it/s, loss=0.1704]
Epoch 28: Loss=0.1684, Val Acc=0.4267
Epoch 29/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.11it/s, loss=0.1669]
Epoch 29: Loss=0.1683, Val Acc=0.4356
Epoch 30/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.51it/s, loss=0.1660]
Epoch 30: Loss=0.1683, Val Acc=0.4089
Epoch 31/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.37it/s, loss=0.1640]
Epoch 31: Loss=0.1682, Val Acc=0.4578
Epoch 32/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.63it/s, loss=0.1729]
Epoch 32: Loss=0.1682, Val Acc=0.4400
Epoch 33/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.77it/s, loss=0.1669]
Epoch 33: Loss=0.1682, Val Acc=0.4756
Epoch 34/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 50.18it/s, loss=0.1728]
Epoch 34: Loss=0.1682, Val Acc=0.4489
Epoch 35/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.31it/s, loss=0.1764]
Epoch 35: Loss=0.1682, Val Acc=0.4933
Epoch 36/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.40it/s, loss=0.1642]
Epoch 36: Loss=0.1682, Val Acc=0.4844
Epoch 37/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.31it/s, loss=0.1669]
Epoch 37: Loss=0.1682, Val Acc=0.4756
Epoch 38/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.93it/s, loss=0.1666]
Epoch 38: Loss=0.1682, Val Acc=0.4444
Epoch 39/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.08it/s, loss=0.1688]
Epoch 39: Loss=0.1682, Val Acc=0.4311
Epoch 40/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.38it/s, loss=0.1648]
Epoch 40: Loss=0.1681, Val Acc=0.4044
Epoch 41/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.61it/s, loss=0.1654]
Epoch 41: Loss=0.1681, Val Acc=0.4400
Epoch 42/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.87it/s, loss=0.1779]
Epoch 42: Loss=0.1681, Val Acc=0.4356
Epoch 43/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.87it/s, loss=0.1639]
Epoch 43: Loss=0.1681, Val Acc=0.4400
Epoch 44/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.58it/s, loss=0.1665]
Epoch 44: Loss=0.1681, Val Acc=0.4444
Epoch 45/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.75it/s, loss=0.1665]
Epoch 45: Loss=0.1681, Val Acc=0.4489
Epoch 46/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.39it/s, loss=0.1698]
Epoch 46: Loss=0.1681, Val Acc=0.4356
Epoch 47/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.61it/s, loss=0.1677]
Epoch 47: Loss=0.1681, Val Acc=0.4444
Epoch 48/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.88it/s, loss=0.1680]
Epoch 48: Loss=0.1681, Val Acc=0.4800
Epoch 49/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 48.12it/s, loss=0.1641]
Epoch 49: Loss=0.1681, Val Acc=0.4533
Epoch 50/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.92it/s, loss=0.1660]
Epoch 50: Loss=0.1681, Val Acc=0.4222
Epoch 51/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.61it/s, loss=0.1779]
Epoch 51: Loss=0.1681, Val Acc=0.4400
Epoch 52/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.98it/s, loss=0.1688]
Epoch 52: Loss=0.1681, Val Acc=0.3867
Epoch 53/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.61it/s, loss=0.1692]
Epoch 53: Loss=0.1681, Val Acc=0.4400
Epoch 54/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.49it/s, loss=0.1647]
Epoch 54: Loss=0.1681, Val Acc=0.4311
Epoch 55/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.95it/s, loss=0.1655]
Epoch 55: Loss=0.1681, Val Acc=0.4489
Epoch 56/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.70it/s, loss=0.1668]
Epoch 56: Loss=0.1681, Val Acc=0.4089
Epoch 57/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.48it/s, loss=0.1710]
Epoch 57: Loss=0.1681, Val Acc=0.4711
Epoch 58/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.43it/s, loss=0.1645]
Epoch 58: Loss=0.1681, Val Acc=0.4133
Epoch 59/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.74it/s, loss=0.1644]
Epoch 59: Loss=0.1681, Val Acc=0.4133
Epoch 60/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.50it/s, loss=0.1737]
Epoch 60: Loss=0.1681, Val Acc=0.3822
Epoch 61/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.64it/s, loss=0.1694]
Epoch 61: Loss=0.1681, Val Acc=0.4444
Epoch 62/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.44it/s, loss=0.1674]
Epoch 62: Loss=0.1681, Val Acc=0.4400
Epoch 63/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.23it/s, loss=0.1680]
Epoch 63: Loss=0.1681, Val Acc=0.4978
Epoch 64/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.89it/s, loss=0.1678]
Epoch 64: Loss=0.1681, Val Acc=0.4267
Epoch 65/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.62it/s, loss=0.1660]
Epoch 65: Loss=0.1681, Val Acc=0.4356
Epoch 66/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.10it/s, loss=0.1657]
Epoch 66: Loss=0.1681, Val Acc=0.4400
Epoch 67/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.99it/s, loss=0.1639]
Epoch 67: Loss=0.1681, Val Acc=0.4267
Epoch 68/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.81it/s, loss=0.1665]
Epoch 68: Loss=0.1681, Val Acc=0.4444
Epoch 69/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.57it/s, loss=0.1672]
Epoch 69: Loss=0.1681, Val Acc=0.4489
Epoch 70/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.63it/s, loss=0.1647]
Epoch 70: Loss=0.1681, Val Acc=0.4178
Epoch 71/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.64it/s, loss=0.1674]
Epoch 71: Loss=0.1681, Val Acc=0.4578
Epoch 72/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.98it/s, loss=0.1709]
Epoch 72: Loss=0.1681, Val Acc=0.4444
Epoch 73/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.99it/s, loss=0.1665]
Epoch 73: Loss=0.1681, Val Acc=0.4356
Epoch 74/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.86it/s, loss=0.1674]
Epoch 74: Loss=0.1681, Val Acc=0.4356
Epoch 75/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.58it/s, loss=0.1672]
Epoch 75: Loss=0.1681, Val Acc=0.4444
Epoch 76/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.26it/s, loss=0.1704]
Epoch 76: Loss=0.1681, Val Acc=0.4267
Epoch 77/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.21it/s, loss=0.1680]
Epoch 77: Loss=0.1681, Val Acc=0.4400
Epoch 78/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.46it/s, loss=0.1670]
Epoch 78: Loss=0.1681, Val Acc=0.4178
Epoch 79/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.32it/s, loss=0.1690]
Epoch 79: Loss=0.1681, Val Acc=0.4622
Epoch 80/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.11it/s, loss=0.1672]
Epoch 80: Loss=0.1681, Val Acc=0.4267
Epoch 81/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.35it/s, loss=0.1779]
Epoch 81: Loss=0.1681, Val Acc=0.4356
Epoch 82/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.11it/s, loss=0.1647]
Epoch 82: Loss=0.1681, Val Acc=0.3956
Epoch 83/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.18it/s, loss=0.1675]
Epoch 83: Loss=0.1681, Val Acc=0.4844
Epoch 84/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.55it/s, loss=0.1694]
Epoch 84: Loss=0.1681, Val Acc=0.4178
Epoch 85/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.07it/s, loss=0.1668]
Epoch 85: Loss=0.1681, Val Acc=0.4933
Epoch 86/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.48it/s, loss=0.1640]
Epoch 86: Loss=0.1681, Val Acc=0.4267
Epoch 87/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.24it/s, loss=0.1660]
Epoch 87: Loss=0.1681, Val Acc=0.4444
Epoch 88/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.43it/s, loss=0.1674]
Epoch 88: Loss=0.1681, Val Acc=0.4044
Epoch 89/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.98it/s, loss=0.1657]
Epoch 89: Loss=0.1681, Val Acc=0.4356
Epoch 90/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.23it/s, loss=0.1691]
Epoch 90: Loss=0.1681, Val Acc=0.4133
Epoch 91/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.87it/s, loss=0.1651]
Epoch 91: Loss=0.1681, Val Acc=0.3867
Epoch 92/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 48.59it/s, loss=0.1668]
Epoch 92: Loss=0.1681, Val Acc=0.4667
Epoch 93/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.85it/s, loss=0.1689]
Epoch 93: Loss=0.1681, Val Acc=0.4578
Epoch 94/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.80it/s, loss=0.1642]
Epoch 94: Loss=0.1681, Val Acc=0.4267
Epoch 95/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.80it/s, loss=0.1674]
Epoch 95: Loss=0.1681, Val Acc=0.4533
Epoch 96/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.58it/s, loss=0.1695]
Epoch 96: Loss=0.1681, Val Acc=0.4489
Epoch 97/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.73it/s, loss=0.1677]
Epoch 97: Loss=0.1681, Val Acc=0.4222
Epoch 98/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.97it/s, loss=0.1672]
Epoch 98: Loss=0.1681, Val Acc=0.4533
Epoch 99/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.52it/s, loss=0.1704]
Epoch 99: Loss=0.1681, Val Acc=0.4178
Epoch 100/100: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.08it/s, loss=0.1678]
Epoch 100: Loss=0.1681, Val Acc=0.4267

==================================================
Final Test: covamnet | 1-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 274.61it/s]

Accuracy : 0.5244
Precision: 0.5446
Recall   : 0.5244
F1-Score : 0.5177
p-value  : 7.97e-18
Saved: results/confusion_matrix_covamnet_1shot_90samples.png
Saved: results/tsne_covamnet_1shot_90samples.png

Results logged to WandB and plots saved to results/
