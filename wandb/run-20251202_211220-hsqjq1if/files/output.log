Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
initialization method [normal]
Epoch 1/70: 100%|███| 100/100 [00:03<00:00, 28.19it/s, loss=0.6215]
Epoch 1: Loss=0.5937, Val Acc=0.8889
  → Best model saved (0.8889)
Epoch 2/70: 100%|███| 100/100 [00:03<00:00, 33.02it/s, loss=0.4615]
Epoch 2: Loss=0.4099, Val Acc=0.9422
  → Best model saved (0.9422)
Epoch 3/70: 100%|███| 100/100 [00:02<00:00, 33.71it/s, loss=0.4975]
Epoch 3: Loss=0.3374, Val Acc=0.9689
  → Best model saved (0.9689)
Epoch 4/70: 100%|███| 100/100 [00:02<00:00, 34.08it/s, loss=0.1925]
Epoch 4: Loss=0.2704, Val Acc=0.9689
Epoch 5/70: 100%|███| 100/100 [00:03<00:00, 32.34it/s, loss=0.2309]
Epoch 5: Loss=0.2493, Val Acc=0.9644
Epoch 6/70: 100%|███| 100/100 [00:03<00:00, 31.88it/s, loss=0.1895]
Epoch 6: Loss=0.2142, Val Acc=0.9778
  → Best model saved (0.9778)
Epoch 7/70: 100%|███| 100/100 [00:02<00:00, 35.34it/s, loss=0.1866]
Epoch 7: Loss=0.1997, Val Acc=0.9733
Epoch 8/70: 100%|███| 100/100 [00:03<00:00, 32.56it/s, loss=0.1976]
Epoch 8: Loss=0.2012, Val Acc=0.9689
Epoch 9/70: 100%|███| 100/100 [00:02<00:00, 35.15it/s, loss=0.1903]
Epoch 9: Loss=0.1879, Val Acc=0.9822
  → Best model saved (0.9822)
Epoch 10/70: 100%|██| 100/100 [00:02<00:00, 34.53it/s, loss=0.1773]
Epoch 10: Loss=0.1856, Val Acc=0.9822
Epoch 11/70: 100%|██| 100/100 [00:03<00:00, 32.37it/s, loss=0.1806]
Epoch 11: Loss=0.1802, Val Acc=0.9822
Epoch 12/70: 100%|██| 100/100 [00:03<00:00, 33.27it/s, loss=0.1755]
Epoch 12: Loss=0.1792, Val Acc=0.9822
Epoch 13/70: 100%|██| 100/100 [00:02<00:00, 33.51it/s, loss=0.1751]
Epoch 13: Loss=0.1785, Val Acc=0.9822
Epoch 14/70: 100%|██| 100/100 [00:03<00:00, 32.83it/s, loss=0.1747]
Epoch 14: Loss=0.1779, Val Acc=0.9822
Epoch 15/70: 100%|██| 100/100 [00:02<00:00, 33.84it/s, loss=0.1833]
Epoch 15: Loss=0.1775, Val Acc=0.9822
Epoch 16/70: 100%|██| 100/100 [00:02<00:00, 34.40it/s, loss=0.1808]
Epoch 16: Loss=0.1769, Val Acc=0.9822
Epoch 17/70: 100%|██| 100/100 [00:02<00:00, 33.66it/s, loss=0.1746]
Epoch 17: Loss=0.1764, Val Acc=0.9822
Epoch 18/70: 100%|██| 100/100 [00:02<00:00, 34.94it/s, loss=0.1725]
Epoch 18: Loss=0.1761, Val Acc=0.9822
Epoch 19/70: 100%|██| 100/100 [00:03<00:00, 32.90it/s, loss=0.1737]
Epoch 19: Loss=0.1755, Val Acc=0.9822
Epoch 20/70: 100%|██| 100/100 [00:03<00:00, 30.29it/s, loss=0.1732]
Epoch 20: Loss=0.1750, Val Acc=0.9822
Epoch 21/70: 100%|██| 100/100 [00:03<00:00, 33.19it/s, loss=0.1732]
Epoch 21: Loss=0.1745, Val Acc=0.9822
Epoch 22/70: 100%|██| 100/100 [00:03<00:00, 32.42it/s, loss=0.1733]
Epoch 22: Loss=0.1744, Val Acc=0.9822
Epoch 23/70: 100%|██| 100/100 [00:02<00:00, 35.29it/s, loss=0.1740]
Epoch 23: Loss=0.1744, Val Acc=0.9822
Epoch 24/70: 100%|██| 100/100 [00:03<00:00, 31.27it/s, loss=0.1747]
Epoch 24: Loss=0.1743, Val Acc=0.9822
Epoch 25/70: 100%|██| 100/100 [00:03<00:00, 32.70it/s, loss=0.1733]
Epoch 25: Loss=0.1743, Val Acc=0.9822
Epoch 26/70: 100%|██| 100/100 [00:02<00:00, 33.72it/s, loss=0.1770]
Epoch 26: Loss=0.1742, Val Acc=0.9822
Epoch 27/70: 100%|██| 100/100 [00:02<00:00, 34.43it/s, loss=0.1743]
Epoch 27: Loss=0.1741, Val Acc=0.9822
Epoch 28/70: 100%|██| 100/100 [00:03<00:00, 32.23it/s, loss=0.1729]
Epoch 28: Loss=0.1741, Val Acc=0.9822
Epoch 29/70: 100%|██| 100/100 [00:02<00:00, 34.97it/s, loss=0.1709]
Epoch 29: Loss=0.1740, Val Acc=0.9822
Epoch 30/70: 100%|██| 100/100 [00:02<00:00, 34.94it/s, loss=0.1739]
Epoch 30: Loss=0.1740, Val Acc=0.9822
Epoch 31/70: 100%|██| 100/100 [00:02<00:00, 33.82it/s, loss=0.1736]
Epoch 31: Loss=0.1739, Val Acc=0.9822
Epoch 32/70: 100%|██| 100/100 [00:02<00:00, 34.77it/s, loss=0.1735]
Epoch 32: Loss=0.1739, Val Acc=0.9822
Epoch 33/70: 100%|██| 100/100 [00:03<00:00, 32.86it/s, loss=0.1826]
Epoch 33: Loss=0.1739, Val Acc=0.9822
Epoch 34/70: 100%|██| 100/100 [00:03<00:00, 33.21it/s, loss=0.1738]
Epoch 34: Loss=0.1738, Val Acc=0.9822
Epoch 35/70: 100%|██| 100/100 [00:03<00:00, 32.52it/s, loss=0.1737]
Epoch 35: Loss=0.1738, Val Acc=0.9822
Epoch 36/70: 100%|██| 100/100 [00:03<00:00, 31.97it/s, loss=0.1727]
Epoch 36: Loss=0.1738, Val Acc=0.9822
Epoch 37/70: 100%|██| 100/100 [00:03<00:00, 32.94it/s, loss=0.1764]
Epoch 37: Loss=0.1738, Val Acc=0.9822
Epoch 38/70: 100%|██| 100/100 [00:03<00:00, 31.85it/s, loss=0.1733]
Epoch 38: Loss=0.1738, Val Acc=0.9822
Epoch 39/70: 100%|██| 100/100 [00:02<00:00, 33.54it/s, loss=0.1720]
Epoch 39: Loss=0.1738, Val Acc=0.9822
Epoch 40/70: 100%|██| 100/100 [00:03<00:00, 32.13it/s, loss=0.1708]
Epoch 40: Loss=0.1738, Val Acc=0.9822
Epoch 41/70: 100%|██| 100/100 [00:02<00:00, 33.55it/s, loss=0.1767]
Epoch 41: Loss=0.1738, Val Acc=0.9822
Epoch 42/70: 100%|██| 100/100 [00:03<00:00, 32.46it/s, loss=0.1737]
Epoch 42: Loss=0.1738, Val Acc=0.9822
Epoch 43/70: 100%|██| 100/100 [00:02<00:00, 34.54it/s, loss=0.1783]
Epoch 43: Loss=0.1738, Val Acc=0.9822
Epoch 44/70: 100%|██| 100/100 [00:03<00:00, 32.83it/s, loss=0.1852]
Epoch 44: Loss=0.1738, Val Acc=0.9822
Epoch 45/70: 100%|██| 100/100 [00:03<00:00, 31.36it/s, loss=0.1732]
Epoch 45: Loss=0.1738, Val Acc=0.9822
Epoch 46/70: 100%|██| 100/100 [00:02<00:00, 33.57it/s, loss=0.1720]
Epoch 46: Loss=0.1738, Val Acc=0.9822
Epoch 47/70: 100%|██| 100/100 [00:03<00:00, 32.78it/s, loss=0.1726]
Epoch 47: Loss=0.1738, Val Acc=0.9822
Epoch 48/70: 100%|██| 100/100 [00:03<00:00, 32.35it/s, loss=0.1719]
Epoch 48: Loss=0.1738, Val Acc=0.9822
Epoch 49/70: 100%|██| 100/100 [00:03<00:00, 32.24it/s, loss=0.1704]
Epoch 49: Loss=0.1738, Val Acc=0.9822
Epoch 50/70: 100%|██| 100/100 [00:03<00:00, 33.01it/s, loss=0.1786]
Epoch 50: Loss=0.1738, Val Acc=0.9822
Epoch 51/70: 100%|██| 100/100 [00:03<00:00, 32.04it/s, loss=0.1692]
Epoch 51: Loss=0.1738, Val Acc=0.9822
Epoch 52/70: 100%|██| 100/100 [00:02<00:00, 33.52it/s, loss=0.1711]
Epoch 52: Loss=0.1738, Val Acc=0.9822
Epoch 53/70: 100%|██| 100/100 [00:03<00:00, 33.19it/s, loss=0.1728]
Epoch 53: Loss=0.1738, Val Acc=0.9822
Epoch 54/70: 100%|██| 100/100 [00:02<00:00, 34.86it/s, loss=0.1738]
Epoch 54: Loss=0.1738, Val Acc=0.9822
Epoch 55/70: 100%|██| 100/100 [00:02<00:00, 35.29it/s, loss=0.1692]
Epoch 55: Loss=0.1738, Val Acc=0.9822
Epoch 56/70: 100%|██| 100/100 [00:03<00:00, 30.75it/s, loss=0.1733]
Epoch 56: Loss=0.1738, Val Acc=0.9822
Epoch 57/70: 100%|██| 100/100 [00:03<00:00, 32.89it/s, loss=0.1725]
Epoch 57: Loss=0.1738, Val Acc=0.9822
Epoch 58/70: 100%|██| 100/100 [00:02<00:00, 33.41it/s, loss=0.1705]
Epoch 58: Loss=0.1738, Val Acc=0.9822
Epoch 59/70: 100%|██| 100/100 [00:03<00:00, 32.79it/s, loss=0.1743]
Epoch 59: Loss=0.1738, Val Acc=0.9822
Epoch 60/70: 100%|██| 100/100 [00:02<00:00, 34.23it/s, loss=0.1724]
Epoch 60: Loss=0.1738, Val Acc=0.9822
Epoch 61/70: 100%|██| 100/100 [00:02<00:00, 33.60it/s, loss=0.1735]
Epoch 61: Loss=0.1738, Val Acc=0.9822
Epoch 62/70: 100%|██| 100/100 [00:02<00:00, 34.28it/s, loss=0.1762]
Epoch 62: Loss=0.1738, Val Acc=0.9822
Epoch 63/70: 100%|██| 100/100 [00:02<00:00, 34.92it/s, loss=0.1726]
Epoch 63: Loss=0.1738, Val Acc=0.9822
Epoch 64/70: 100%|██| 100/100 [00:02<00:00, 35.36it/s, loss=0.1723]
Epoch 64: Loss=0.1738, Val Acc=0.9822
Epoch 65/70: 100%|██| 100/100 [00:03<00:00, 32.03it/s, loss=0.1726]
Epoch 65: Loss=0.1738, Val Acc=0.9822
Epoch 66/70: 100%|██| 100/100 [00:03<00:00, 31.58it/s, loss=0.1728]
Epoch 66: Loss=0.1738, Val Acc=0.9822
Epoch 67/70: 100%|██| 100/100 [00:02<00:00, 33.57it/s, loss=0.1708]
Epoch 67: Loss=0.1738, Val Acc=0.9822
Epoch 68/70: 100%|██| 100/100 [00:02<00:00, 33.54it/s, loss=0.1724]
Epoch 68: Loss=0.1738, Val Acc=0.9822
Epoch 69/70: 100%|██| 100/100 [00:03<00:00, 32.16it/s, loss=0.1720]
Epoch 69: Loss=0.1738, Val Acc=0.9822
Epoch 70/70: 100%|██| 100/100 [00:02<00:00, 34.26it/s, loss=0.1726]
Epoch 70: Loss=0.1738, Val Acc=0.9822

==================================================
Final Test: cosine | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|██████████████████| 150/150 [00:00<00:00, 406.82it/s]

Accuracy : 1.0000
Precision: 1.0000
Recall   : 1.0000
F1-Score : 1.0000
p-value  : 9.81e-198
Saved: results/confusion_matrix_cosine_5shot_allsamples.png
Saved: results/tsne_cosine_5shot_allsamples.png

Results logged to WandB and plots saved to results/
