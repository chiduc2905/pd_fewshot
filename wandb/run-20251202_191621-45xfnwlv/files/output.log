Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 90 training samples (30/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.20it/s, loss=1.2486]
Epoch 1: Loss=1.1008, Val Acc=0.5644
  → Best model saved (0.5644)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.71it/s, loss=0.7747]
Epoch 2: Loss=0.8426, Val Acc=0.7378
  → Best model saved (0.7378)
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.38it/s, loss=0.3197]
Epoch 3: Loss=0.5854, Val Acc=0.5467
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.23it/s, loss=0.4735]
Epoch 4: Loss=0.4148, Val Acc=0.7511
  → Best model saved (0.7511)
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.96it/s, loss=0.2670]
Epoch 5: Loss=0.3489, Val Acc=0.5600
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.62it/s, loss=0.2771]
Epoch 6: Loss=0.3026, Val Acc=0.5644
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.60it/s, loss=0.1933]
Epoch 7: Loss=0.3132, Val Acc=0.8844
  → Best model saved (0.8844)
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.96it/s, loss=0.2012]
Epoch 8: Loss=0.2626, Val Acc=0.9467
  → Best model saved (0.9467)
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.99it/s, loss=0.1962]
Epoch 9: Loss=0.2222, Val Acc=0.8978
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.99it/s, loss=0.2392]
Epoch 10: Loss=0.2132, Val Acc=0.9111
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.19it/s, loss=0.2184]
Epoch 11: Loss=0.2043, Val Acc=0.9111
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.65it/s, loss=0.1939]
Epoch 12: Loss=0.2138, Val Acc=0.9289
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.56it/s, loss=0.1863]
Epoch 13: Loss=0.1962, Val Acc=0.9378
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.08it/s, loss=0.3070]
Epoch 14: Loss=0.2057, Val Acc=0.9111
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.94it/s, loss=0.1869]
Epoch 15: Loss=0.1973, Val Acc=0.9467
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.98it/s, loss=0.1876]
Epoch 16: Loss=0.1972, Val Acc=0.9467
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.81it/s, loss=0.1864]
Epoch 17: Loss=0.1962, Val Acc=0.9511
  → Best model saved (0.9511)
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.98it/s, loss=0.1916]
Epoch 18: Loss=0.2000, Val Acc=0.9244
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.29it/s, loss=0.2058]
Epoch 19: Loss=0.1951, Val Acc=0.9556
  → Best model saved (0.9556)
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.60it/s, loss=0.2364]
Epoch 20: Loss=0.1924, Val Acc=0.9511
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.22it/s, loss=0.1876]
Epoch 21: Loss=0.1946, Val Acc=0.9600
  → Best model saved (0.9600)
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.63it/s, loss=0.1868]
Epoch 22: Loss=0.1987, Val Acc=0.9556
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.14it/s, loss=0.1876]
Epoch 23: Loss=0.1919, Val Acc=0.9556
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.48it/s, loss=0.1890]
Epoch 24: Loss=0.1971, Val Acc=0.9467
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.38it/s, loss=0.1867]
Epoch 25: Loss=0.1954, Val Acc=0.9556
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.53it/s, loss=0.1887]
Epoch 26: Loss=0.1943, Val Acc=0.9600
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.83it/s, loss=0.1982]
Epoch 27: Loss=0.1918, Val Acc=0.9467
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.97it/s, loss=0.1888]
Epoch 28: Loss=0.1950, Val Acc=0.9333
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.06it/s, loss=0.1893]
Epoch 29: Loss=0.1943, Val Acc=0.9511
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.86it/s, loss=0.1884]
Epoch 30: Loss=0.1952, Val Acc=0.9511
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.81it/s, loss=0.1883]
Epoch 31: Loss=0.1917, Val Acc=0.9467
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.97it/s, loss=0.1875]
Epoch 32: Loss=0.1910, Val Acc=0.9467
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.13it/s, loss=0.2190]
Epoch 33: Loss=0.1924, Val Acc=0.9556
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.17it/s, loss=0.1858]
Epoch 34: Loss=0.1900, Val Acc=0.9556
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.69it/s, loss=0.1904]
Epoch 35: Loss=0.1953, Val Acc=0.9333
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.22it/s, loss=0.1854]
Epoch 36: Loss=0.1929, Val Acc=0.9511
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.78it/s, loss=0.1883]
Epoch 37: Loss=0.1963, Val Acc=0.9467
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.19it/s, loss=0.1886]
Epoch 38: Loss=0.1976, Val Acc=0.9511
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.41it/s, loss=0.1863]
Epoch 39: Loss=0.1922, Val Acc=0.9467
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.09it/s, loss=0.1858]
Epoch 40: Loss=0.1933, Val Acc=0.9289
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.72it/s, loss=0.1881]
Epoch 41: Loss=0.1948, Val Acc=0.9511
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.34it/s, loss=0.1890]
Epoch 42: Loss=0.2006, Val Acc=0.9556
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.15it/s, loss=0.1874]
Epoch 43: Loss=0.1921, Val Acc=0.9422
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.60it/s, loss=0.1981]
Epoch 44: Loss=0.1936, Val Acc=0.9467
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.56it/s, loss=0.1878]
Epoch 45: Loss=0.1953, Val Acc=0.9467
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.46it/s, loss=0.1892]
Epoch 46: Loss=0.1931, Val Acc=0.9422
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.06it/s, loss=0.1903]
Epoch 47: Loss=0.1962, Val Acc=0.9511
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.44it/s, loss=0.1886]
Epoch 48: Loss=0.1964, Val Acc=0.9467
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.04it/s, loss=0.1855]
Epoch 49: Loss=0.1898, Val Acc=0.9467
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.44it/s, loss=0.1865]
Epoch 50: Loss=0.1910, Val Acc=0.9378
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.55it/s, loss=0.2344]
Epoch 51: Loss=0.1923, Val Acc=0.9467
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.61it/s, loss=0.1859]
Epoch 52: Loss=0.1942, Val Acc=0.9467
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.98it/s, loss=0.1858]
Epoch 53: Loss=0.1929, Val Acc=0.9467
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.73it/s, loss=0.1855]
Epoch 54: Loss=0.1983, Val Acc=0.9511
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.82it/s, loss=0.1857]
Epoch 55: Loss=0.1939, Val Acc=0.9511
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.84it/s, loss=0.1880]
Epoch 56: Loss=0.1940, Val Acc=0.9511
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.30it/s, loss=0.1877]
Epoch 57: Loss=0.1897, Val Acc=0.9511
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.16it/s, loss=0.1884]
Epoch 58: Loss=0.1914, Val Acc=0.9467
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.65it/s, loss=0.1857]
Epoch 59: Loss=0.1901, Val Acc=0.9511
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.26it/s, loss=0.1855]
Epoch 60: Loss=0.1931, Val Acc=0.9467
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.27it/s, loss=0.1909]
Epoch 61: Loss=0.2101, Val Acc=0.9467
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.24it/s, loss=0.1913]
Epoch 62: Loss=0.1912, Val Acc=0.9556
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.89it/s, loss=0.1872]
Epoch 63: Loss=0.1970, Val Acc=0.9511
Epoch 64/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.00it/s, loss=0.1886]
Epoch 64: Loss=0.1993, Val Acc=0.9422
Epoch 65/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.15it/s, loss=0.1858]
Epoch 65: Loss=0.1961, Val Acc=0.9467
Epoch 66/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.09it/s, loss=0.1862]
Epoch 66: Loss=0.1938, Val Acc=0.9556
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.51it/s, loss=0.1921]
Epoch 67: Loss=0.1906, Val Acc=0.9467
Epoch 68/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.35it/s, loss=0.1892]
Epoch 68: Loss=0.1950, Val Acc=0.9422
Epoch 69/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.65it/s, loss=0.1892]
Epoch 69: Loss=0.1919, Val Acc=0.9467
Epoch 70/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.16it/s, loss=0.1854]
Epoch 70: Loss=0.1922, Val Acc=0.9467

==================================================
Final Test: covamnet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 256.21it/s]

Accuracy : 0.9600
Precision: 0.9636
Recall   : 0.9600
F1-Score : 0.9604
p-value  : 5.85e-175
Saved: results/confusion_matrix_covamnet_5shot_90samples.png
Saved: results/tsne_covamnet_5shot_90samples.png

Results logged to WandB and plots saved to results/
