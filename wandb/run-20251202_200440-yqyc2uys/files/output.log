Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 30 training samples (10/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 73.09it/s, loss=0.2124]
Epoch 1: Loss=0.3170, Val Acc=0.8133
  → Best model saved (0.8133)
Epoch 2/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 121.10it/s, loss=0.2010]
Epoch 2: Loss=0.2166, Val Acc=0.9022
  → Best model saved (0.9022)
Epoch 3/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 130.08it/s, loss=0.1956]
Epoch 3: Loss=0.2022, Val Acc=0.9333
  → Best model saved (0.9333)
Epoch 4/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 139.04it/s, loss=0.1936]
Epoch 4: Loss=0.2096, Val Acc=0.9156
Epoch 5/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.91it/s, loss=0.1938]
Epoch 5: Loss=0.1919, Val Acc=0.9067
Epoch 6/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 133.96it/s, loss=0.1831]
Epoch 6: Loss=0.1876, Val Acc=0.9200
Epoch 7/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 129.29it/s, loss=0.1808]
Epoch 7: Loss=0.1839, Val Acc=0.9200
Epoch 8/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 127.07it/s, loss=0.1820]
Epoch 8: Loss=0.1803, Val Acc=0.9244
Epoch 9/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.32it/s, loss=0.1788]
Epoch 9: Loss=0.1767, Val Acc=0.9200
Epoch 10/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 106.26it/s, loss=0.1685]
Epoch 10: Loss=0.1733, Val Acc=0.9200
Epoch 11/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.15it/s, loss=0.1680]
Epoch 11: Loss=0.1712, Val Acc=0.9200
Epoch 12/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.28it/s, loss=0.1703]
Epoch 12: Loss=0.1709, Val Acc=0.9200
Epoch 13/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 103.24it/s, loss=0.1702]
Epoch 13: Loss=0.1705, Val Acc=0.9200
Epoch 14/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.54it/s, loss=0.1687]
Epoch 14: Loss=0.1701, Val Acc=0.9244
Epoch 15/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 117.38it/s, loss=0.1656]
Epoch 15: Loss=0.1697, Val Acc=0.9200
Epoch 16/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.27it/s, loss=0.1729]
Epoch 16: Loss=0.1693, Val Acc=0.9156
Epoch 17/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.83it/s, loss=0.1651]
Epoch 17: Loss=0.1688, Val Acc=0.9200
Epoch 18/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.55it/s, loss=0.1680]
Epoch 18: Loss=0.1684, Val Acc=0.9156
Epoch 19/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 127.25it/s, loss=0.1670]
Epoch 19: Loss=0.1679, Val Acc=0.9244
Epoch 20/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 123.07it/s, loss=0.1666]
Epoch 20: Loss=0.1675, Val Acc=0.9244
Epoch 21/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.41it/s, loss=0.1631]
Epoch 21: Loss=0.1672, Val Acc=0.9244
Epoch 22/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 128.57it/s, loss=0.1643]
Epoch 22: Loss=0.1671, Val Acc=0.9244
Epoch 23/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.12it/s, loss=0.1640]
Epoch 23: Loss=0.1670, Val Acc=0.9244
Epoch 24/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.42it/s, loss=0.1641]
Epoch 24: Loss=0.1670, Val Acc=0.9200
Epoch 25/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 133.28it/s, loss=0.1629]
Epoch 25: Loss=0.1669, Val Acc=0.9244
Epoch 26/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.73it/s, loss=0.1681]
Epoch 26: Loss=0.1669, Val Acc=0.9244
Epoch 27/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 130.03it/s, loss=0.1659]
Epoch 27: Loss=0.1668, Val Acc=0.9200
Epoch 28/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 117.62it/s, loss=0.1685]
Epoch 28: Loss=0.1667, Val Acc=0.9200
Epoch 29/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.45it/s, loss=0.1669]
Epoch 29: Loss=0.1667, Val Acc=0.9244
Epoch 30/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 141.12it/s, loss=0.1645]
Epoch 30: Loss=0.1666, Val Acc=0.9244
Epoch 31/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 140.93it/s, loss=0.1636]
Epoch 31: Loss=0.1666, Val Acc=0.9244
Epoch 32/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 128.16it/s, loss=0.1681]
Epoch 32: Loss=0.1666, Val Acc=0.9244
Epoch 33/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.73it/s, loss=0.1665]
Epoch 33: Loss=0.1666, Val Acc=0.9244
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.61it/s, loss=0.1657]
Epoch 34: Loss=0.1665, Val Acc=0.9244
Epoch 35/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.80it/s, loss=0.1662]
Epoch 35: Loss=0.1665, Val Acc=0.9244
Epoch 36/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.46it/s, loss=0.1658]
Epoch 36: Loss=0.1665, Val Acc=0.9244
Epoch 37/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.87it/s, loss=0.1629]
Epoch 37: Loss=0.1665, Val Acc=0.9244
Epoch 38/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.68it/s, loss=0.1733]
Epoch 38: Loss=0.1665, Val Acc=0.9200
Epoch 39/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 112.51it/s, loss=0.1628]
Epoch 39: Loss=0.1665, Val Acc=0.9244
Epoch 40/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.14it/s, loss=0.1653]
Epoch 40: Loss=0.1665, Val Acc=0.9244
Epoch 41/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.20it/s, loss=0.1697]
Epoch 41: Loss=0.1665, Val Acc=0.9244
Epoch 42/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.50it/s, loss=0.1636]
Epoch 42: Loss=0.1665, Val Acc=0.9244
Epoch 43/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.23it/s, loss=0.1714]
Epoch 43: Loss=0.1665, Val Acc=0.9244
Epoch 44/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 101.11it/s, loss=0.1719]
Epoch 44: Loss=0.1665, Val Acc=0.9200
Epoch 45/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.40it/s, loss=0.1732]
Epoch 45: Loss=0.1665, Val Acc=0.9200
Epoch 46/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.41it/s, loss=0.1631]
Epoch 46: Loss=0.1665, Val Acc=0.9244
Epoch 47/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.22it/s, loss=0.1641]
Epoch 47: Loss=0.1665, Val Acc=0.9200
Epoch 48/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.05it/s, loss=0.1638]
Epoch 48: Loss=0.1665, Val Acc=0.9244
Epoch 49/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 134.42it/s, loss=0.1630]
Epoch 49: Loss=0.1665, Val Acc=0.9244
Epoch 50/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 122.33it/s, loss=0.1704]
Epoch 50: Loss=0.1665, Val Acc=0.9244
Epoch 51/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.20it/s, loss=0.1650]
Epoch 51: Loss=0.1665, Val Acc=0.9200
Epoch 52/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 123.00it/s, loss=0.1682]
Epoch 52: Loss=0.1665, Val Acc=0.9244
Epoch 53/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.31it/s, loss=0.1637]
Epoch 53: Loss=0.1665, Val Acc=0.9200
Epoch 54/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 129.57it/s, loss=0.1656]
Epoch 54: Loss=0.1665, Val Acc=0.9200
Epoch 55/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.10it/s, loss=0.1650]
Epoch 55: Loss=0.1665, Val Acc=0.9244
Epoch 56/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 133.43it/s, loss=0.1651]
Epoch 56: Loss=0.1665, Val Acc=0.9244
Epoch 57/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.40it/s, loss=0.1669]
Epoch 57: Loss=0.1665, Val Acc=0.9244
Epoch 58/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.31it/s, loss=0.1662]
Epoch 58: Loss=0.1665, Val Acc=0.9200
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 97.66it/s, loss=0.1636]
Epoch 59: Loss=0.1665, Val Acc=0.9244
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 93.20it/s, loss=0.1665]
Epoch 60: Loss=0.1665, Val Acc=0.9244
Epoch 61/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 125.76it/s, loss=0.1663]
Epoch 61: Loss=0.1665, Val Acc=0.9244
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.83it/s, loss=0.1631]
Epoch 62: Loss=0.1665, Val Acc=0.9244
Epoch 63/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 137.27it/s, loss=0.1624]
Epoch 63: Loss=0.1665, Val Acc=0.9244
Epoch 64/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 102.46it/s, loss=0.1640]
Epoch 64: Loss=0.1665, Val Acc=0.9244
Epoch 65/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.21it/s, loss=0.1641]
Epoch 65: Loss=0.1665, Val Acc=0.9244
Epoch 66/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.80it/s, loss=0.1677]
Epoch 66: Loss=0.1665, Val Acc=0.9200
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.09it/s, loss=0.1668]
Epoch 67: Loss=0.1665, Val Acc=0.9244
Epoch 68/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.40it/s, loss=0.1659]
Epoch 68: Loss=0.1665, Val Acc=0.9244
Epoch 69/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 133.78it/s, loss=0.1628]
Epoch 69: Loss=0.1665, Val Acc=0.9244
Epoch 70/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.84it/s, loss=0.1641]
Epoch 70: Loss=0.1665, Val Acc=0.9244

==================================================
Final Test: protonet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 465.22it/s]

Accuracy : 0.9267
Precision: 0.9392
Recall   : 0.9267
F1-Score : 0.9256
p-value  : 4.71e-157
Saved: results/confusion_matrix_protonet_5shot_30samples.png
Saved: results/tsne_protonet_5shot_30samples.png

Results logged to WandB and plots saved to results/
