Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 30 training samples (10/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 28.26it/s, loss=0.2165]
Epoch 1: Loss=0.4228, Val Acc=0.9378
  → Best model saved (0.9378)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.77it/s, loss=0.1931]
Epoch 2: Loss=0.2002, Val Acc=0.9378
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 29.61it/s, loss=0.1883]
Epoch 3: Loss=0.1920, Val Acc=0.9600
  → Best model saved (0.9600)
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.01it/s, loss=0.1831]
Epoch 4: Loss=0.1876, Val Acc=0.9600
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.93it/s, loss=0.1830]
Epoch 5: Loss=0.1816, Val Acc=0.9556
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.80it/s, loss=0.1696]
Epoch 6: Loss=0.1752, Val Acc=0.9644
  → Best model saved (0.9644)
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.60it/s, loss=0.1652]
Epoch 7: Loss=0.1706, Val Acc=0.9067
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.53it/s, loss=0.1671]
Epoch 8: Loss=0.1665, Val Acc=0.9111
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.45it/s, loss=0.1634]
Epoch 9: Loss=0.1605, Val Acc=0.9689
  → Best model saved (0.9689)
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.19it/s, loss=0.1513]
Epoch 10: Loss=0.1584, Val Acc=0.9156
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.66it/s, loss=0.1500]
Epoch 11: Loss=0.1541, Val Acc=0.9467
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.65it/s, loss=0.1531]
Epoch 12: Loss=0.1532, Val Acc=0.9644
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.37it/s, loss=0.1518]
Epoch 13: Loss=0.1525, Val Acc=0.9644
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.93it/s, loss=0.1512]
Epoch 14: Loss=0.1518, Val Acc=0.9467
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.00it/s, loss=0.1471]
Epoch 15: Loss=0.1513, Val Acc=0.9556
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.36it/s, loss=0.1546]
Epoch 16: Loss=0.1508, Val Acc=0.9644
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.08it/s, loss=0.1455]
Epoch 17: Loss=0.1502, Val Acc=0.9644
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.31it/s, loss=0.1489]
Epoch 18: Loss=0.1496, Val Acc=0.9689
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.33it/s, loss=0.1468]
Epoch 19: Loss=0.1491, Val Acc=0.9600
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.60it/s, loss=0.1478]
Epoch 20: Loss=0.1485, Val Acc=0.9644
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.47it/s, loss=0.1448]
Epoch 21: Loss=0.1481, Val Acc=0.9556
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.29it/s, loss=0.1453]
Epoch 22: Loss=0.1481, Val Acc=0.9600
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 29.62it/s, loss=0.1452]
Epoch 23: Loss=0.1480, Val Acc=0.9689
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.87it/s, loss=0.1450]
Epoch 24: Loss=0.1480, Val Acc=0.9600
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.17it/s, loss=0.1450]
Epoch 25: Loss=0.1479, Val Acc=0.9600
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.43it/s, loss=0.1480]
Epoch 26: Loss=0.1478, Val Acc=0.9600
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.69it/s, loss=0.1459]
Epoch 27: Loss=0.1478, Val Acc=0.9644
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.63it/s, loss=0.1496]
Epoch 28: Loss=0.1477, Val Acc=0.9689
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.49it/s, loss=0.1463]
Epoch 29: Loss=0.1476, Val Acc=0.9556
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.22it/s, loss=0.1442]
Epoch 30: Loss=0.1476, Val Acc=0.9644
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.03it/s, loss=0.1447]
Epoch 31: Loss=0.1475, Val Acc=0.9556
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.26it/s, loss=0.1487]
Epoch 32: Loss=0.1475, Val Acc=0.9644
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.11it/s, loss=0.1473]
Epoch 33: Loss=0.1475, Val Acc=0.9600
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.34it/s, loss=0.1456]
Epoch 34: Loss=0.1475, Val Acc=0.9644
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.67it/s, loss=0.1461]
Epoch 35: Loss=0.1475, Val Acc=0.9556
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 29.50it/s, loss=0.1455]
Epoch 36: Loss=0.1475, Val Acc=0.9689
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.87it/s, loss=0.1458]
Epoch 37: Loss=0.1475, Val Acc=0.9556
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.03it/s, loss=0.1518]
Epoch 38: Loss=0.1475, Val Acc=0.9556
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.60it/s, loss=0.1432]
Epoch 39: Loss=0.1475, Val Acc=0.9644
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.54it/s, loss=0.1470]
Epoch 40: Loss=0.1475, Val Acc=0.9600
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.90it/s, loss=0.1494]
Epoch 41: Loss=0.1474, Val Acc=0.9644
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.71it/s, loss=0.1444]
Epoch 42: Loss=0.1474, Val Acc=0.9644
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.86it/s, loss=0.1532]
Epoch 43: Loss=0.1474, Val Acc=0.9689
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.03it/s, loss=0.1537]
Epoch 44: Loss=0.1474, Val Acc=0.9689
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.86it/s, loss=0.1518]
Epoch 45: Loss=0.1474, Val Acc=0.9689
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.98it/s, loss=0.1459]
Epoch 46: Loss=0.1474, Val Acc=0.9556
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.81it/s, loss=0.1453]
Epoch 47: Loss=0.1474, Val Acc=0.9644
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.55it/s, loss=0.1449]
Epoch 48: Loss=0.1474, Val Acc=0.9600
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.49it/s, loss=0.1438]
Epoch 49: Loss=0.1474, Val Acc=0.9556
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.34it/s, loss=0.1517]
Epoch 50: Loss=0.1474, Val Acc=0.9600
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.92it/s, loss=0.1460]
Epoch 51: Loss=0.1474, Val Acc=0.9644
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.10it/s, loss=0.1499]
Epoch 52: Loss=0.1474, Val Acc=0.9644
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.41it/s, loss=0.1447]
Epoch 53: Loss=0.1474, Val Acc=0.9644
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.20it/s, loss=0.1456]
Epoch 54: Loss=0.1474, Val Acc=0.9644
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.12it/s, loss=0.1460]
Epoch 55: Loss=0.1474, Val Acc=0.9556
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.62it/s, loss=0.1447]
Epoch 56: Loss=0.1474, Val Acc=0.9556
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.06it/s, loss=0.1481]
Epoch 57: Loss=0.1474, Val Acc=0.9600
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.62it/s, loss=0.1469]
Epoch 58: Loss=0.1474, Val Acc=0.9644
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.76it/s, loss=0.1446]
Epoch 59: Loss=0.1474, Val Acc=0.9600
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.82it/s, loss=0.1467]
Epoch 60: Loss=0.1474, Val Acc=0.9644
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.02it/s, loss=0.1472]
Epoch 61: Loss=0.1474, Val Acc=0.9600
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.33it/s, loss=0.1458]
Epoch 62: Loss=0.1474, Val Acc=0.9600
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.92it/s, loss=0.1441]
Epoch 63: Loss=0.1474, Val Acc=0.9644
Epoch 64/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.38it/s, loss=0.1455]
Epoch 64: Loss=0.1474, Val Acc=0.9600
Epoch 65/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.46it/s, loss=0.1453]
Epoch 65: Loss=0.1474, Val Acc=0.9644
Epoch 66/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.46it/s, loss=0.1493]
Epoch 66: Loss=0.1474, Val Acc=0.9644
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.29it/s, loss=0.1457]
Epoch 67: Loss=0.1474, Val Acc=0.9600
Epoch 68/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.08it/s, loss=0.1470]
Epoch 68: Loss=0.1474, Val Acc=0.9600
Epoch 69/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.48it/s, loss=0.1432]
Epoch 69: Loss=0.1474, Val Acc=0.9556
Epoch 70/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.53it/s, loss=0.1453]
Epoch 70: Loss=0.1474, Val Acc=0.9600

==================================================
Final Test: protonet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 448.96it/s]

Accuracy : 0.9533
Precision: 0.9582
Recall   : 0.9533
F1-Score : 0.9540
p-value  : 2.67e-171
Saved: results/confusion_matrix_protonet_5shot_30samples.png
Saved: results/tsne_protonet_5shot_30samples.png

Results logged to WandB and plots saved to results/
