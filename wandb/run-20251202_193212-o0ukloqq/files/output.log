Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 90 training samples (30/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 26.37it/s, loss=0.3859]
Epoch 1: Loss=0.5540, Val Acc=0.3956
  → Best model saved (0.3956)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.45it/s, loss=0.2575]
Epoch 2: Loss=0.3239, Val Acc=0.3333
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 30.82it/s, loss=0.2506]
Epoch 3: Loss=0.2366, Val Acc=0.3911
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.00it/s, loss=0.2061]
Epoch 4: Loss=0.2012, Val Acc=0.3022
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.73it/s, loss=0.1997]
Epoch 5: Loss=0.1909, Val Acc=0.4133
  → Best model saved (0.4133)
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.21it/s, loss=0.1920]
Epoch 6: Loss=0.1882, Val Acc=0.3333
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.03it/s, loss=0.2409]
Epoch 7: Loss=0.1943, Val Acc=0.3778
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.97it/s, loss=0.1807]
Epoch 8: Loss=0.1842, Val Acc=0.3422
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.13it/s, loss=0.1728]
Epoch 9: Loss=0.1779, Val Acc=0.3022
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.22it/s, loss=0.1774]
Epoch 10: Loss=0.1754, Val Acc=0.3200
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.60it/s, loss=0.1696]
Epoch 11: Loss=0.1730, Val Acc=0.3467
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.21it/s, loss=0.1792]
Epoch 12: Loss=0.1719, Val Acc=0.3067
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.08it/s, loss=0.1695]
Epoch 13: Loss=0.1713, Val Acc=0.3289
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.88it/s, loss=0.1757]
Epoch 14: Loss=0.1706, Val Acc=0.3244
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.13it/s, loss=0.1700]
Epoch 15: Loss=0.1701, Val Acc=0.3156
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.41it/s, loss=0.1671]
Epoch 16: Loss=0.1696, Val Acc=0.3200
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.90it/s, loss=0.1693]
Epoch 17: Loss=0.1692, Val Acc=0.3200
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.49it/s, loss=0.1772]
Epoch 18: Loss=0.1688, Val Acc=0.2933
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.31it/s, loss=0.1649]
Epoch 19: Loss=0.1683, Val Acc=0.2889
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.79it/s, loss=0.1706]
Epoch 20: Loss=0.1678, Val Acc=0.3200
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.91it/s, loss=0.1691]
Epoch 21: Loss=0.1675, Val Acc=0.2933
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.99it/s, loss=0.1647]
Epoch 22: Loss=0.1674, Val Acc=0.3022
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.08it/s, loss=0.1692]
Epoch 23: Loss=0.1673, Val Acc=0.2933
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.59it/s, loss=0.1695]
Epoch 24: Loss=0.1672, Val Acc=0.3022
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.76it/s, loss=0.1662]
Epoch 25: Loss=0.1672, Val Acc=0.3022
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.32it/s, loss=0.1694]
Epoch 26: Loss=0.1671, Val Acc=0.3067
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.12it/s, loss=0.1663]
Epoch 27: Loss=0.1671, Val Acc=0.3156
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.37it/s, loss=0.1656]
Epoch 28: Loss=0.1670, Val Acc=0.3289
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.04it/s, loss=0.1647]
Epoch 29: Loss=0.1670, Val Acc=0.3156
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.46it/s, loss=0.1705]
Epoch 30: Loss=0.1669, Val Acc=0.3200
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.67it/s, loss=0.1712]
Epoch 31: Loss=0.1669, Val Acc=0.3200
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.80it/s, loss=0.1642]
Epoch 32: Loss=0.1669, Val Acc=0.3289
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.31it/s, loss=0.1656]
Epoch 33: Loss=0.1668, Val Acc=0.3067
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.25it/s, loss=0.1651]
Epoch 34: Loss=0.1668, Val Acc=0.3111
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.52it/s, loss=0.1683]
Epoch 35: Loss=0.1668, Val Acc=0.3111
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.24it/s, loss=0.1636]
Epoch 36: Loss=0.1668, Val Acc=0.3111
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.39it/s, loss=0.1630]
Epoch 37: Loss=0.1668, Val Acc=0.3200
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.81it/s, loss=0.1691]
Epoch 38: Loss=0.1668, Val Acc=0.3067
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.88it/s, loss=0.1665]
Epoch 39: Loss=0.1668, Val Acc=0.3244
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.44it/s, loss=0.1631]
Epoch 40: Loss=0.1668, Val Acc=0.3289
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.45it/s, loss=0.1663]
Epoch 41: Loss=0.1668, Val Acc=0.3200
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.32it/s, loss=0.1647]
Epoch 42: Loss=0.1668, Val Acc=0.3200
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.61it/s, loss=0.1660]
Epoch 43: Loss=0.1668, Val Acc=0.3244
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.17it/s, loss=0.1655]
Epoch 44: Loss=0.1668, Val Acc=0.3022
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.94it/s, loss=0.1700]
Epoch 45: Loss=0.1668, Val Acc=0.3156
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.71it/s, loss=0.1702]
Epoch 46: Loss=0.1668, Val Acc=0.3022
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.92it/s, loss=0.1740]
Epoch 47: Loss=0.1668, Val Acc=0.2978
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.17it/s, loss=0.1729]
Epoch 48: Loss=0.1668, Val Acc=0.2978
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.64it/s, loss=0.1635]
Epoch 49: Loss=0.1668, Val Acc=0.3067
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.72it/s, loss=0.1670]
Epoch 50: Loss=0.1668, Val Acc=0.3111
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.87it/s, loss=0.1647]
Epoch 51: Loss=0.1668, Val Acc=0.3200
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.79it/s, loss=0.1665]
Epoch 52: Loss=0.1668, Val Acc=0.3111
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.00it/s, loss=0.1637]
Epoch 53: Loss=0.1668, Val Acc=0.3067
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.19it/s, loss=0.1642]
Epoch 54: Loss=0.1668, Val Acc=0.3244
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 30.59it/s, loss=0.1655]
Epoch 55: Loss=0.1668, Val Acc=0.3200
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.68it/s, loss=0.1660]
Epoch 56: Loss=0.1668, Val Acc=0.3022
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.52it/s, loss=0.1647]
Epoch 57: Loss=0.1668, Val Acc=0.3244
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.00it/s, loss=0.1639]
Epoch 58: Loss=0.1668, Val Acc=0.3067
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.61it/s, loss=0.1667]
Epoch 59: Loss=0.1668, Val Acc=0.3022
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.43it/s, loss=0.1665]
Epoch 60: Loss=0.1668, Val Acc=0.3200
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.42it/s, loss=0.1681]
Epoch 61: Loss=0.1668, Val Acc=0.3022
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.53it/s, loss=0.1753]
Epoch 62: Loss=0.1668, Val Acc=0.2933
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.40it/s, loss=0.1652]
Epoch 63: Loss=0.1668, Val Acc=0.3244
Epoch 64/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.63it/s, loss=0.1698]
Epoch 64: Loss=0.1668, Val Acc=0.2933
Epoch 65/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.45it/s, loss=0.1627]
Epoch 65: Loss=0.1668, Val Acc=0.3067
Epoch 66/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.23it/s, loss=0.1672]
Epoch 66: Loss=0.1668, Val Acc=0.3022
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.42it/s, loss=0.1660]
Epoch 67: Loss=0.1668, Val Acc=0.3022
Epoch 68/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.30it/s, loss=0.1655]
Epoch 68: Loss=0.1668, Val Acc=0.3022
Epoch 69/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.57it/s, loss=0.1624]
Epoch 69: Loss=0.1668, Val Acc=0.3111
Epoch 70/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.03it/s, loss=0.1642]
Epoch 70: Loss=0.1668, Val Acc=0.3200

==================================================
Final Test: covamnet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 253.25it/s]
/home/ubuntu/anaconda3/envs/scalogram/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])

Accuracy : 0.4067
Precision: 0.4437
Recall   : 0.4067
F1-Score : 0.2962
p-value  : 9.67e-04
Saved: results/confusion_matrix_covamnet_5shot_90samples.png
Saved: results/tsne_covamnet_5shot_90samples.png

Results logged to WandB and plots saved to results/
