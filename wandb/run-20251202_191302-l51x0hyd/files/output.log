Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 60 training samples (20/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.88it/s, loss=1.5866]
Epoch 1: Loss=1.0630, Val Acc=0.5733
  → Best model saved (0.5733)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.54it/s, loss=1.2650]
Epoch 2: Loss=0.8084, Val Acc=0.6622
  → Best model saved (0.6622)
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.76it/s, loss=0.2352]
Epoch 3: Loss=0.5466, Val Acc=0.6444
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.15it/s, loss=0.2123]
Epoch 4: Loss=0.3396, Val Acc=0.6933
  → Best model saved (0.6933)
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.30it/s, loss=0.1954]
Epoch 5: Loss=0.3512, Val Acc=0.6400
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 39.77it/s, loss=0.2723]
Epoch 6: Loss=0.2559, Val Acc=0.5956
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.89it/s, loss=0.1910]
Epoch 7: Loss=0.2591, Val Acc=0.6222
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.49it/s, loss=0.2219]
Epoch 8: Loss=0.2466, Val Acc=0.6444
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.24it/s, loss=0.1899]
Epoch 9: Loss=0.2196, Val Acc=0.6489
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.84it/s, loss=0.1891]
Epoch 10: Loss=0.2219, Val Acc=0.6667
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.21it/s, loss=0.2119]
Epoch 11: Loss=0.1988, Val Acc=0.6844
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.54it/s, loss=0.2141]
Epoch 12: Loss=0.2031, Val Acc=0.7022
  → Best model saved (0.7022)
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.86it/s, loss=0.1889]
Epoch 13: Loss=0.2139, Val Acc=0.7022
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.02it/s, loss=0.1897]
Epoch 14: Loss=0.2037, Val Acc=0.6978
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.45it/s, loss=0.1857]
Epoch 15: Loss=0.1957, Val Acc=0.7067
  → Best model saved (0.7067)
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.93it/s, loss=0.1883]
Epoch 16: Loss=0.1949, Val Acc=0.7067
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.46it/s, loss=0.1918]
Epoch 17: Loss=0.1963, Val Acc=0.6978
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.64it/s, loss=0.1872]
Epoch 18: Loss=0.2008, Val Acc=0.7022
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.75it/s, loss=0.1898]
Epoch 19: Loss=0.1938, Val Acc=0.7022
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.07it/s, loss=0.1879]
Epoch 20: Loss=0.1930, Val Acc=0.6933
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.76it/s, loss=0.1847]
Epoch 21: Loss=0.1928, Val Acc=0.6933
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.89it/s, loss=0.1884]
Epoch 22: Loss=0.1979, Val Acc=0.6800
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.65it/s, loss=0.1847]
Epoch 23: Loss=0.1957, Val Acc=0.6933
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.40it/s, loss=0.1861]
Epoch 24: Loss=0.1949, Val Acc=0.7022
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.48it/s, loss=0.1864]
Epoch 25: Loss=0.1932, Val Acc=0.6933
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.55it/s, loss=0.1881]
Epoch 26: Loss=0.1961, Val Acc=0.6889
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 48.02it/s, loss=0.1860]
Epoch 27: Loss=0.1949, Val Acc=0.7022
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.70it/s, loss=0.1851]
Epoch 28: Loss=0.1929, Val Acc=0.6800
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.26it/s, loss=0.1892]
Epoch 29: Loss=0.1917, Val Acc=0.6844
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.88it/s, loss=0.1982]
Epoch 30: Loss=0.1932, Val Acc=0.7022
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.79it/s, loss=0.1859]
Epoch 31: Loss=0.1901, Val Acc=0.6933
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.69it/s, loss=0.1877]
Epoch 32: Loss=0.1931, Val Acc=0.6844
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.75it/s, loss=0.3172]
Epoch 33: Loss=0.1921, Val Acc=0.6978
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.20it/s, loss=0.1879]
Epoch 34: Loss=0.1947, Val Acc=0.6844
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.70it/s, loss=0.1911]
Epoch 35: Loss=0.1942, Val Acc=0.6844
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.40it/s, loss=0.1886]
Epoch 36: Loss=0.1929, Val Acc=0.7022
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.34it/s, loss=0.1854]
Epoch 37: Loss=0.1932, Val Acc=0.7022
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.62it/s, loss=0.1858]
Epoch 38: Loss=0.1954, Val Acc=0.6978
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.62it/s, loss=0.1911]
Epoch 39: Loss=0.1922, Val Acc=0.6933
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.31it/s, loss=0.1893]
Epoch 40: Loss=0.1917, Val Acc=0.6800
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.80it/s, loss=0.1854]
Epoch 41: Loss=0.1948, Val Acc=0.6889
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.96it/s, loss=0.1889]
Epoch 42: Loss=0.1906, Val Acc=0.6756
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.73it/s, loss=0.1873]
Epoch 43: Loss=0.1958, Val Acc=0.6844
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.35it/s, loss=0.1861]
Epoch 44: Loss=0.1899, Val Acc=0.6800
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.49it/s, loss=0.1894]
Epoch 45: Loss=0.1926, Val Acc=0.6978
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.91it/s, loss=0.1858]
Epoch 46: Loss=0.1902, Val Acc=0.6933
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.03it/s, loss=0.1927]
Epoch 47: Loss=0.1919, Val Acc=0.7067
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.04it/s, loss=0.1897]
Epoch 48: Loss=0.1904, Val Acc=0.6933
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.64it/s, loss=0.1888]
Epoch 49: Loss=0.1913, Val Acc=0.6933
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.90it/s, loss=0.1861]
Epoch 50: Loss=0.1922, Val Acc=0.6800
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.05it/s, loss=0.2866]
Epoch 51: Loss=0.1913, Val Acc=0.6756
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.94it/s, loss=0.1887]
Epoch 52: Loss=0.1904, Val Acc=0.6978
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.12it/s, loss=0.1856]
Epoch 53: Loss=0.1934, Val Acc=0.6978
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.61it/s, loss=0.1878]
Epoch 54: Loss=0.1915, Val Acc=0.6756
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.27it/s, loss=0.1859]
Epoch 55: Loss=0.1915, Val Acc=0.6667
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.68it/s, loss=0.1873]
Epoch 56: Loss=0.1916, Val Acc=0.7022
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.36it/s, loss=0.1891]
Epoch 57: Loss=0.1981, Val Acc=0.6489
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.99it/s, loss=0.1852]
Epoch 58: Loss=0.1906, Val Acc=0.6844
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.61it/s, loss=0.1852]
Epoch 59: Loss=0.1907, Val Acc=0.7111
  → Best model saved (0.7111)
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.27it/s, loss=0.1952]
Epoch 60: Loss=0.1903, Val Acc=0.6933
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.86it/s, loss=0.1869]
Epoch 61: Loss=0.1992, Val Acc=0.6889
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.86it/s, loss=0.1883]
Epoch 62: Loss=0.1998, Val Acc=0.7022
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.93it/s, loss=0.1874]
Epoch 63: Loss=0.1915, Val Acc=0.6933
Epoch 64/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.01it/s, loss=0.1927]
Epoch 64: Loss=0.1917, Val Acc=0.6711
Epoch 65/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.54it/s, loss=0.1853]
Epoch 65: Loss=0.1907, Val Acc=0.6578
Epoch 66/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.80it/s, loss=0.2125]
Epoch 66: Loss=0.1909, Val Acc=0.6756
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.35it/s, loss=0.2547]
Epoch 67: Loss=0.1901, Val Acc=0.6844
Epoch 68/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.51it/s, loss=0.1859]
Epoch 68: Loss=0.1943, Val Acc=0.6622
Epoch 69/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.90it/s, loss=0.1934]
Epoch 69: Loss=0.1969, Val Acc=0.6933
Epoch 70/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.07it/s, loss=0.1879]
Epoch 70: Loss=0.1921, Val Acc=0.6533

==================================================
Final Test: covamnet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 240.43it/s]

Accuracy : 0.7467
Precision: 0.8476
Recall   : 0.7467
F1-Score : 0.7009
p-value  : 3.21e-77
Saved: results/confusion_matrix_covamnet_5shot_60samples.png
Saved: results/tsne_covamnet_5shot_60samples.png

Results logged to WandB and plots saved to results/
