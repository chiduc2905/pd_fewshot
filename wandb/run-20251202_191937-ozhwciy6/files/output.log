Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.66it/s, loss=0.8497]
Epoch 1: Loss=1.0471, Val Acc=0.6133
  → Best model saved (0.6133)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.30it/s, loss=0.5968]
Epoch 2: Loss=0.8502, Val Acc=0.6578
  → Best model saved (0.6578)
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.60it/s, loss=0.2591]
Epoch 3: Loss=0.6101, Val Acc=0.5689
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.41it/s, loss=0.2478]
Epoch 4: Loss=0.4747, Val Acc=0.7689
  → Best model saved (0.7689)
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.88it/s, loss=0.1998]
Epoch 5: Loss=0.4150, Val Acc=0.8222
  → Best model saved (0.8222)
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.21it/s, loss=0.2356]
Epoch 6: Loss=0.3663, Val Acc=0.7822
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.78it/s, loss=0.2070]
Epoch 7: Loss=0.3317, Val Acc=0.7956
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.27it/s, loss=0.1929]
Epoch 8: Loss=0.2794, Val Acc=0.9022
  → Best model saved (0.9022)
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.62it/s, loss=0.5723]
Epoch 9: Loss=0.2638, Val Acc=0.9244
  → Best model saved (0.9244)
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.82it/s, loss=0.1950]
Epoch 10: Loss=0.2910, Val Acc=0.9378
  → Best model saved (0.9378)
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.56it/s, loss=0.4367]
Epoch 11: Loss=0.2665, Val Acc=0.9378
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.35it/s, loss=0.1880]
Epoch 12: Loss=0.2396, Val Acc=0.9289
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.85it/s, loss=0.1886]
Epoch 13: Loss=0.2184, Val Acc=0.9333
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.94it/s, loss=0.1963]
Epoch 14: Loss=0.2325, Val Acc=0.9378
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.20it/s, loss=0.1881]
Epoch 15: Loss=0.2153, Val Acc=0.9289
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.76it/s, loss=0.2030]
Epoch 16: Loss=0.2211, Val Acc=0.9378
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.19it/s, loss=0.1906]
Epoch 17: Loss=0.2279, Val Acc=0.9244
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.37it/s, loss=0.1867]
Epoch 18: Loss=0.2145, Val Acc=0.9244
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.34it/s, loss=0.2147]
Epoch 19: Loss=0.2154, Val Acc=0.9244
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.61it/s, loss=0.1944]
Epoch 20: Loss=0.2112, Val Acc=0.9156
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.93it/s, loss=0.1933]
Epoch 21: Loss=0.2113, Val Acc=0.9244
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.85it/s, loss=0.1881]
Epoch 22: Loss=0.2171, Val Acc=0.9289
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 39.74it/s, loss=0.1935]
Epoch 23: Loss=0.2093, Val Acc=0.9244
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.40it/s, loss=0.1937]
Epoch 24: Loss=0.2091, Val Acc=0.9200
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.04it/s, loss=0.1854]
Epoch 25: Loss=0.2119, Val Acc=0.9333
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.41it/s, loss=0.2101]
Epoch 26: Loss=0.2092, Val Acc=0.9289
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.41it/s, loss=0.2004]
Epoch 27: Loss=0.2031, Val Acc=0.9244
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.74it/s, loss=0.2045]
Epoch 28: Loss=0.2165, Val Acc=0.9244
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 47.65it/s, loss=0.1855]
Epoch 29: Loss=0.2216, Val Acc=0.9244
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.12it/s, loss=0.1902]
Epoch 30: Loss=0.2031, Val Acc=0.9289
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.77it/s, loss=0.1860]
Epoch 31: Loss=0.2042, Val Acc=0.8889
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.85it/s, loss=0.1928]
Epoch 32: Loss=0.1996, Val Acc=0.9289
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.88it/s, loss=0.1935]
Epoch 33: Loss=0.2060, Val Acc=0.9289
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.85it/s, loss=0.1879]
Epoch 34: Loss=0.2053, Val Acc=0.9244
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.70it/s, loss=0.1866]
Epoch 35: Loss=0.2179, Val Acc=0.9289
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.39it/s, loss=0.1856]
Epoch 36: Loss=0.2044, Val Acc=0.9244
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.68it/s, loss=0.1918]
Epoch 37: Loss=0.2037, Val Acc=0.9244
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.45it/s, loss=0.2465]
Epoch 38: Loss=0.2113, Val Acc=0.9289
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.33it/s, loss=0.1884]
Epoch 39: Loss=0.2152, Val Acc=0.9244
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.68it/s, loss=0.2058]
Epoch 40: Loss=0.2032, Val Acc=0.9244
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.14it/s, loss=0.1886]
Epoch 41: Loss=0.2022, Val Acc=0.9289
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.57it/s, loss=0.1866]
Epoch 42: Loss=0.2014, Val Acc=0.9244
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.04it/s, loss=0.1858]
Epoch 43: Loss=0.2234, Val Acc=0.9289
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.57it/s, loss=0.1888]
Epoch 44: Loss=0.2040, Val Acc=0.9244
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.86it/s, loss=0.1863]
Epoch 45: Loss=0.2234, Val Acc=0.9244
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.81it/s, loss=0.1855]
Epoch 46: Loss=0.2130, Val Acc=0.9378
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.25it/s, loss=0.1897]
Epoch 47: Loss=0.2157, Val Acc=0.9289
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.44it/s, loss=0.1959]
Epoch 48: Loss=0.2191, Val Acc=0.9378
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.75it/s, loss=0.1865]
Epoch 49: Loss=0.2143, Val Acc=0.9244
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.33it/s, loss=0.1892]
Epoch 50: Loss=0.2059, Val Acc=0.9289
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 41.90it/s, loss=0.2060]
Epoch 51: Loss=0.2122, Val Acc=0.9244
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.55it/s, loss=0.1872]
Epoch 52: Loss=0.2072, Val Acc=0.9244
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.10it/s, loss=0.2011]
Epoch 53: Loss=0.2003, Val Acc=0.9244
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.72it/s, loss=0.3677]
Epoch 54: Loss=0.2066, Val Acc=0.8800
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.72it/s, loss=0.1880]
Epoch 55: Loss=0.1997, Val Acc=0.9244
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.16it/s, loss=0.2967]
Epoch 56: Loss=0.2004, Val Acc=0.9289
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.41it/s, loss=0.1910]
Epoch 57: Loss=0.2082, Val Acc=0.9244
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.34it/s, loss=0.4043]
Epoch 58: Loss=0.2168, Val Acc=0.9289
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.21it/s, loss=0.1857]
Epoch 59: Loss=0.1982, Val Acc=0.9244
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.63it/s, loss=0.1865]
Epoch 60: Loss=0.2021, Val Acc=0.9244
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 46.79it/s, loss=0.1950]
Epoch 61: Loss=0.2062, Val Acc=0.9156
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 42.50it/s, loss=0.1900]
Epoch 62: Loss=0.2187, Val Acc=0.9156
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.85it/s, loss=0.1914]
Epoch 63: Loss=0.2034, Val Acc=0.9289
Epoch 64/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 45.55it/s, loss=0.2028]
Epoch 64: Loss=0.2147, Val Acc=0.9289
Epoch 65/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.15it/s, loss=0.1871]
Epoch 65: Loss=0.2085, Val Acc=0.9244
Epoch 66/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.65it/s, loss=0.1896]
Epoch 66: Loss=0.2140, Val Acc=0.9244
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 40.95it/s, loss=0.1872]
Epoch 67: Loss=0.2036, Val Acc=0.9333
Epoch 68/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 43.10it/s, loss=0.1873]
Epoch 68: Loss=0.2040, Val Acc=0.9200
Epoch 69/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.96it/s, loss=0.1855]
Epoch 69: Loss=0.2097, Val Acc=0.9289
Epoch 70/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 44.85it/s, loss=0.1933]
Epoch 70: Loss=0.1982, Val Acc=0.8933

==================================================
Final Test: covamnet | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 247.81it/s]

Accuracy : 0.9467
Precision: 0.9500
Recall   : 0.9467
F1-Score : 0.9463
p-value  : 1.11e-167
Saved: results/confusion_matrix_covamnet_5shot_allsamples.png
Saved: results/tsne_covamnet_5shot_allsamples.png

Results logged to WandB and plots saved to results/
