Dataset: /mnt/disk2/nhatnc/res/scalogram_fewshot/pd_fewshot/scalogram_images
Split: 30/class for val, 30/class for test, rest for train
Computing mean/std on training set...
  Mean: ['0.040', '0.060', '0.623']
  Std:  ['0.177', '0.205', '0.156']
Loaded: Train=171, Val=90, Test=90
Using 90 training samples (30/class)
initialization method [normal]
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 48.09it/s, loss=0.6721]
Epoch 1: Loss=0.7978, Val Acc=0.8978
  → Best model saved (0.8978)
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.09it/s, loss=0.6373]
Epoch 2: Loss=0.6326, Val Acc=0.9467
  → Best model saved (0.9467)
Epoch 3/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 121.35it/s, loss=0.5751]
Epoch 3: Loss=0.5879, Val Acc=0.9156
Epoch 4/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 104.39it/s, loss=0.5639]
Epoch 4: Loss=0.5742, Val Acc=0.9289
Epoch 5/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.08it/s, loss=0.5719]
Epoch 5: Loss=0.5658, Val Acc=0.9333
Epoch 6/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.05it/s, loss=0.5676]
Epoch 6: Loss=0.5593, Val Acc=0.9511
  → Best model saved (0.9511)
Epoch 7/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.88it/s, loss=0.5455]
Epoch 7: Loss=0.5534, Val Acc=0.9689
  → Best model saved (0.9689)
Epoch 8/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.44it/s, loss=0.5692]
Epoch 8: Loss=0.5478, Val Acc=0.9333
Epoch 9/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.72it/s, loss=0.5457]
Epoch 9: Loss=0.5418, Val Acc=0.9689
Epoch 10/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.05it/s, loss=0.5283]
Epoch 10: Loss=0.5392, Val Acc=0.9689
Epoch 11/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.72it/s, loss=0.5318]
Epoch 11: Loss=0.5346, Val Acc=0.9511
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.86it/s, loss=0.5373]
Epoch 12: Loss=0.5334, Val Acc=0.9511
Epoch 13/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 114.75it/s, loss=0.5401]
Epoch 13: Loss=0.5328, Val Acc=0.9467
Epoch 14/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 112.19it/s, loss=0.5377]
Epoch 14: Loss=0.5322, Val Acc=0.9511
Epoch 15/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 103.98it/s, loss=0.5257]
Epoch 15: Loss=0.5316, Val Acc=0.9511
Epoch 16/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.71it/s, loss=0.5500]
Epoch 16: Loss=0.5311, Val Acc=0.9333
Epoch 17/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.42it/s, loss=0.5385]
Epoch 17: Loss=0.5305, Val Acc=0.9556
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 94.55it/s, loss=0.5363]
Epoch 18: Loss=0.5300, Val Acc=0.9600
Epoch 19/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.75it/s, loss=0.5265]
Epoch 19: Loss=0.5295, Val Acc=0.9511
Epoch 20/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.77it/s, loss=0.5281]
Epoch 20: Loss=0.5289, Val Acc=0.9644
Epoch 21/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.07it/s, loss=0.5343]
Epoch 21: Loss=0.5285, Val Acc=0.9689
Epoch 22/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.71it/s, loss=0.5325]
Epoch 22: Loss=0.5284, Val Acc=0.9511
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 90.47it/s, loss=0.5287]
Epoch 23: Loss=0.5284, Val Acc=0.9600
Epoch 24/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.07it/s, loss=0.5308]
Epoch 24: Loss=0.5283, Val Acc=0.9644
Epoch 25/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.31it/s, loss=0.5253]
Epoch 25: Loss=0.5282, Val Acc=0.9556
Epoch 26/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.61it/s, loss=0.5287]
Epoch 26: Loss=0.5282, Val Acc=0.9644
Epoch 27/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 106.42it/s, loss=0.5303]
Epoch 27: Loss=0.5281, Val Acc=0.9733
  → Best model saved (0.9733)
Epoch 28/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.15it/s, loss=0.5269]
Epoch 28: Loss=0.5281, Val Acc=0.9733
Epoch 29/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 102.91it/s, loss=0.5225]
Epoch 29: Loss=0.5280, Val Acc=0.9644
Epoch 30/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.34it/s, loss=0.5369]
Epoch 30: Loss=0.5280, Val Acc=0.9422
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.68it/s, loss=0.5283]
Epoch 31: Loss=0.5279, Val Acc=0.9689
Epoch 32/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.37it/s, loss=0.5273]
Epoch 32: Loss=0.5279, Val Acc=0.9689
Epoch 33/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.91it/s, loss=0.5389]
Epoch 33: Loss=0.5279, Val Acc=0.9467
Epoch 34/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 121.46it/s, loss=0.5301]
Epoch 34: Loss=0.5279, Val Acc=0.9333
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.31it/s, loss=0.5289]
Epoch 35: Loss=0.5279, Val Acc=0.9422
Epoch 36/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.08it/s, loss=0.5246]
Epoch 36: Loss=0.5279, Val Acc=0.9511
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 95.52it/s, loss=0.5276]
Epoch 37: Loss=0.5278, Val Acc=0.9511
Epoch 38/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 124.50it/s, loss=0.5255]
Epoch 38: Loss=0.5278, Val Acc=0.9511
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.48it/s, loss=0.5219]
Epoch 39: Loss=0.5278, Val Acc=0.9511
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 96.44it/s, loss=0.5331]
Epoch 40: Loss=0.5278, Val Acc=0.9511
Epoch 41/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.38it/s, loss=0.5230]
Epoch 41: Loss=0.5278, Val Acc=0.9556
Epoch 42/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 112.29it/s, loss=0.5432]
Epoch 42: Loss=0.5278, Val Acc=0.9378
Epoch 43/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.82it/s, loss=0.5330]
Epoch 43: Loss=0.5278, Val Acc=0.9378
Epoch 44/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 113.33it/s, loss=0.5238]
Epoch 44: Loss=0.5278, Val Acc=0.9556
Epoch 45/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 101.74it/s, loss=0.5255]
Epoch 45: Loss=0.5278, Val Acc=0.9511
Epoch 46/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 111.10it/s, loss=0.5219]
Epoch 46: Loss=0.5278, Val Acc=0.9733
Epoch 47/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.91it/s, loss=0.5241]
Epoch 47: Loss=0.5278, Val Acc=0.9600
Epoch 48/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.62it/s, loss=0.5241]
Epoch 48: Loss=0.5278, Val Acc=0.9644
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.91it/s, loss=0.5206]
Epoch 49: Loss=0.5278, Val Acc=0.9689
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.78it/s, loss=0.5476]
Epoch 50: Loss=0.5278, Val Acc=0.9333
Epoch 51/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 119.33it/s, loss=0.5277]
Epoch 51: Loss=0.5278, Val Acc=0.9511
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 98.78it/s, loss=0.5404]
Epoch 52: Loss=0.5278, Val Acc=0.9511
Epoch 53/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 115.21it/s, loss=0.5319]
Epoch 53: Loss=0.5278, Val Acc=0.9467
Epoch 54/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 108.25it/s, loss=0.5301]
Epoch 54: Loss=0.5278, Val Acc=0.9556
Epoch 55/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.13it/s, loss=0.5277]
Epoch 55: Loss=0.5278, Val Acc=0.9644
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 87.26it/s, loss=0.5280]
Epoch 56: Loss=0.5278, Val Acc=0.9689
Epoch 57/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 110.78it/s, loss=0.5213]
Epoch 57: Loss=0.5278, Val Acc=0.9511
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 71.46it/s, loss=0.5325]
Epoch 58: Loss=0.5278, Val Acc=0.9556
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 85.60it/s, loss=0.5302]
Epoch 59: Loss=0.5278, Val Acc=0.9511
Epoch 60/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 120.13it/s, loss=0.5276]
Epoch 60: Loss=0.5278, Val Acc=0.9689
Epoch 61/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.91it/s, loss=0.5206]
Epoch 61: Loss=0.5278, Val Acc=0.9689
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 81.47it/s, loss=0.5286]
Epoch 62: Loss=0.5278, Val Acc=0.9422
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:01<00:00, 99.16it/s, loss=0.5334]
Epoch 63: Loss=0.5278, Val Acc=0.9733
Epoch 64/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.05it/s, loss=0.5252]
Epoch 64: Loss=0.5278, Val Acc=0.9511
Epoch 65/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 118.60it/s, loss=0.5241]
Epoch 65: Loss=0.5278, Val Acc=0.9422
Epoch 66/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 126.44it/s, loss=0.5253]
Epoch 66: Loss=0.5278, Val Acc=0.9600
Epoch 67/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 109.37it/s, loss=0.5341]
Epoch 67: Loss=0.5278, Val Acc=0.9556
Epoch 68/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 107.73it/s, loss=0.5269]
Epoch 68: Loss=0.5278, Val Acc=0.9689
Epoch 69/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 116.07it/s, loss=0.5219]
Epoch 69: Loss=0.5278, Val Acc=0.9556
Epoch 70/70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:00<00:00, 105.07it/s, loss=0.5241]
Epoch 70: Loss=0.5278, Val Acc=0.9422

==================================================
Final Test: cosine | 5-shot
150 episodes × 3 classes × 1 query = 450 predictions
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 443.00it/s]

Accuracy : 0.9867
Precision: 0.9872
Recall   : 0.9867
F1-Score : 0.9867
p-value  : 5.49e-190
Saved: results/confusion_matrix_cosine_5shot_90samples.png
Saved: results/tsne_cosine_5shot_90samples.png

Results logged to WandB and plots saved to results/
